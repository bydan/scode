<%@ Template Language="C#" TargetLanguage="C#" Description="Template de la capa de Acceso a Datos" ResponseEncoding="ASCII" %>    	
<%@ CodeTemplate Src="..\CommonCode\CommonCode.cs" Inherits="Me.CommonCode" Language="C#" TargetLanguage="C#" Description="A base class for the entities." ResponseEncoding="ASCII" %>
<%@ Assembly Name="SchemaExplorer" %>
<%@ Import Namespace="SchemaExplorer" %>
<%@ Import Namespace="System.Collections" %>
<%@ Property Name="NombreProgramador" Type="System.String" Default="Byron Chavez" Category="Options" Description="Nombre del Programdor" %>
<%@ Property Name="Package" Type="System.String" Default="Indefinido" Category="Options" Description="Nombre de la Entidad" %>
<%@ Property Name="TablaBase" Type="SchemaExplorer.TableSchema" EXCLUDED="true"	Category="Context"%>
<%@ Property Name="Empresa" Type="System.String" Default="Byron Chavez" Category="Options" Description="Nombre de la Empresa" %>
<%@ Property Name="TablasBaseCompuestoJunction" Type="SchemaExplorer.TableSchemaCollection" Category="Context"%>
<%@ Property Name="TablasBaseCompuestoDetalle" Type="SchemaExplorer.TableSchemaCollection" 	Category="Context"%>
<%@ Property Name="TiposGeneracion" Type="System.String" Default=" " Category="Options" Description="Nombre de la Entidad" %>


<script runat="template">		
public String GetBusquedaFromForeigKeysSession() 
		{
			String strTablaClaseRelacionada=string.Empty;
										
			
			foreach(ColumnSchema columnSchema in TablaBase.Columns)
			{
				if(columnSchema.IsForeignKeyMember)
				{
										
					strTablaClaseRelacionada+=" else if(httpSession.getAttribute(\"BusquedaDesdeForeignKeySesion"+GetNombreClaseRelacionadaFromColumn(columnSchema)+"\")!=null)";
					strTablaClaseRelacionada+=" {";
							
					strTablaClaseRelacionada+="\r\n\t\t\t\tif(httpSession.getAttribute(\""+columnSchema.Name+"Actual\")!=null)";
					strTablaClaseRelacionada+=" {";
					strTablaClaseRelacionada+="\r\n\t\t\t\t\tsAccionBusqueda=\""+strFK+"_"+strIdGetSet+GetNombreClaseRelacionadaFromColumn(columnSchema)+"\";";						
					strTablaClaseRelacionada+="\r\n\t\t\t\t}";
								
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\thttpSession.removeAttribute(\"BusquedaDesdeForeignKeySesion"+GetNombreClaseRelacionadaFromColumn(columnSchema)+"\");";
					
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\tsUltimaBusqueda=\"accionBusqueda=\"+sAccionBusqueda+\"()"+GetNameControlHtml(columnSchema)+strFK+"_"+strIdGetSet+GetNombreClaseRelacionadaFromColumn(columnSchema)+"=\"+httpSession.getAttribute(\""+columnSchema.Name+"Actual\")+\"()inicio=0()fin=10()tipo=SIGUIENTES\";";
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\thttpSession.removeAttribute(\""+columnSchema.Name+"Actual\");";
					
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\tmensaje=new Mensaje(\"Auxiliar\",\"Ultima Busqueda\",sUltimaBusqueda,MensajeGrupo.NONE);";
					strTablaClaseRelacionada+="\r\n\t\t\t\tsXml = mensaje.toNewXmlMensaje();";

					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\thttpServletResponse.setContentType(\"text/xml\");";
					strTablaClaseRelacionada+="\r\n\t\t\t\thttpServletResponse.getWriter().write(sXml);";
				
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\treturn;";
					
					strTablaClaseRelacionada+="\r\n\t\t\t}";
						
					
			
				}
			}
			
				
			return strTablaClaseRelacionada; 
		}
		
public String GetFuncionesAccionesNavegacionTablasClasesRelacionadasC() 
		{
			String strTablaClaseRelacionada=string.Empty;
			System.Collections.Hashtable tablasRelacionadas=GetTablasRelacionadas(TablaBase);
			
			TableSchema tablaRelacionadaObjetivo;
			String strPlural=string.Empty;
			ArrayList tablasRelacionadasEncontradas=new ArrayList();
			bool encontrado=false;
			
			foreach(CollectionInfo collectionInfo in tablasRelacionadas.Values)
			{
				
				if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne)
				{
					tablaRelacionadaObjetivo=collectionInfo.SecondaryTableSchema;
				}	
				else if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToMany)
				{
					
					tablaRelacionadaObjetivo=collectionInfo.SecondaryTableSchema;
				}
				else
				{
					tablaRelacionadaObjetivo=collectionInfo.JunctionTableSchema;
				}
				
				
				encontrado=false;
				
				foreach(TableSchema tableSchema in tablasRelacionadasEncontradas)
				{
					if(tableSchema.Equals(tablaRelacionadaObjetivo))
					{
						encontrado=true;
					}
				}
				
				
				if(!encontrado)
				{
					
					tablasRelacionadasEncontradas.Add(tablaRelacionadaObjetivo);
					
					strPlural=GetPluralTituloNombreTableFromPropertiesC(tablaRelacionadaObjetivo);
					
					strTablaClaseRelacionada+=" else if(sAccionMantenimiento.equals(\"RegistrarSesion"+GetNombreClaseC(TablaBase.ToString())+"Para"+GetNombreClaseC(tablaRelacionadaObjetivo.ToString())+strPlural+"\"))";
					strTablaClaseRelacionada+=" {";
					strTablaClaseRelacionada+="\r\n\t\t\t\tLong big"+strIdGetSet+GetNombreClaseC(TablaBase.ToString())+"Actual=Long.parseLong(httpServletRequest.getParameter(\""+strId+GetNombreClaseC(TablaBase.ToString())+"Actual\"));";
					strTablaClaseRelacionada+="\r\n\t\t\t\thttpSession.setAttribute(\"BusquedaDesdeForeignKeySesion"+GetNombreClaseC(TablaBase.ToString())+"\",true);";
					strTablaClaseRelacionada+="\r\n\t\t\t\thttpSession.setAttribute(\""+strId+GetNombreClaseC(TablaBase.ToString())+"Actual\", big"+strIdGetSet+GetNombreClaseC(TablaBase.ToString())+"Actual);";
					
					strTablaClaseRelacionada+="\r\n\t\t\t\thttpSession.setAttribute(\"BusquedaDesdeForeignKeySesionForeignKey"+GetNombreClaseC(TablaBase.ToString())+"\",true);";
					strTablaClaseRelacionada+="\r\n\t\t\t\thttpSession.setAttribute(\""+strId+GetNombreClaseC(TablaBase.ToString())+"ActualForeignKey\", big"+strIdGetSet+GetNombreClaseC(TablaBase.ToString())+"Actual);";
					
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\tString strPagina=\"NONE\";";
					strTablaClaseRelacionada+="\r\n\t\t\t\t"+strGlobalSeguridadComment+"SistemaLogicAdditional sistemaLogicAdditional=new SistemaLogicAdditional();";
					
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\t"+strGlobalSeguridadComment+"if(sistemaLogicAdditional.TienePermisosEnPaginaWeb(usuarioActual, Constantes.getLOidSistemaActual(), \"Mantenimiento"+GetNombreClaseC(tablaRelacionadaObjetivo.ToString())+".jsp\"))";
					strTablaClaseRelacionada+="\r\n\t\t\t\t"+strGlobalSeguridadComment+"{";
					strTablaClaseRelacionada+="\r\n\t\t\t\t\tstrPagina=Constantes.SCARPETAPAGINAS+\"/\"+\""+GetRelativePathNavegacionFromTableFromPropertiesC(tablaRelacionadaObjetivo)+"Mantenimiento"+GetNombreClaseC(tablaRelacionadaObjetivo.ToString())+".jsp\";";
					strTablaClaseRelacionada+="\r\n\t\t\t\t"+strGlobalSeguridadComment+"}";
					
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\tmensaje=new Mensaje(\"Auxiliar\",\"Registro de sesion\",strPagina,MensajeGrupo.NONE);";
					strTablaClaseRelacionada+="\r\n\t\t\t\tsXml = mensaje.toNewXmlMensaje();";
						
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t\thttpServletResponse.setContentType(\"text/xml\");";
					strTablaClaseRelacionada+="\r\n\t\t\t\thttpServletResponse.getWriter().write(sXml);";
					strTablaClaseRelacionada+="\r\n\t\t\t}";
				}
				
			}
								
			return strTablaClaseRelacionada; 
		}
		
public String GenerarAccionesImagenServlet() 
{
			String strFuncionesAccionesImagen="";	
			
			foreach(ColumnSchema columnSchema in TablaBase.Columns)
			{				
				if((columnSchema.NativeType=="image"&&columnSchema.DataType==DbType.Binary&&columnSchema.Name!=strVersionRow)||(columnSchema.DataType==DbType.Binary&&columnSchema.Name!=strVersionRow))
				{
					strFuncionesAccionesImagen+=" else if(sAccionMantenimiento.equals(\"cargarImagen"+GetNombreClase(TablaBase.ToString())+GetNombreColumnaClaseC(columnSchema)+"\"))";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tString str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual=\"\";";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\tif(httpSession.getAttribute(\""+strId+GetNombreClase(TablaBase.ToString())+"Actual\")!=null)";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tstr"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual=(String)httpSession.getAttribute(\""+strId+GetNombreClase(TablaBase.ToString())+"Actual\");";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\tif(str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual.equals(\"0\"))";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\tthrow new Exception(\"Seleccione nuevamente un "+GetNombreClaseObjeto(TablaBase.ToString())+"\");";						  										 
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t}";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t}";http://www.forosdelweb.com/clear.gif
					strFuncionesAccionesImagen+=" else";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tthrow new Exception(\"No existe algun "+GetNombreClaseObjeto(TablaBase.ToString())+" seleccionado\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t}";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t"+GetNombreClaseObjeto(TablaBase.ToString())+"Logic.getEntity(Long.parseLong(str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual));";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\ttry";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tFileItemFactory factory = new DiskFileItemFactory();";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tServletFileUpload upload = new ServletFileUpload(factory);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tList fileItems = upload.parseRequest(httpServletRequest);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tString nombreFicheroFoto=\"\";";
						
						
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tIterator i = fileItems.iterator();";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tFileItem actual = null;";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tbyte bytFoto[]=new byte[1];";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tLong lngTamanioFichero=0L;";
					
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\tString fileName = \"\";";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\twhile (i.hasNext())";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\tactual = (FileItem)i.next();";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\tfileName = actual.getName();";
						
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\t\tif(fileName != null)";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\t\tFile fichero = new File(fileName);";
						
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\t\t\tif(!fichero.getName().contains(\"jpg\"))";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\t\t\t;";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\t\t}";
					strFuncionesAccionesImagen+=" else";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\t\t\tlngTamanioFichero=actual.getSize();";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\t\t\t\tif(lngTamanioFichero>100000)";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\t\t\t\tthrow new Exception(\"El archivo no debe superar los 100 kb\");";						             	
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\t\t\t}";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\t\t}";
								
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\t\t\tbytFoto =actual.get();";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\t\t\tbreak;";
					
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\t}";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t}";
						
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\t"+GetNombreClaseObjeto(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablaBase.ToString())+"().set"+GetPrefijoTablaC()+GetPrefijoTipoC(columnSchema)+GetNombreColumnaClaseC(columnSchema)+"(bytFoto);";
					
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\tif(fileName.contains(\"\\\\\"))";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\tfileName=fileName.replace(\"\\\\\",\"@\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t\tfileName=fileName.split(\"@\")[fileName.split(\"@\").length-1];";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t}";
					
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t\t"+GetNombreClaseObjeto(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablaBase.ToString())+"().setField_strNombre(fileName);";					
					
						
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\t"+GetNombreClaseObjeto(TablaBase.ToString())+"Logic.save"+GetNombreClase(TablaBase.ToString())+"WithConnection(iIdUsuarioSesion);";
						
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\trequest.setAttribute(\""+strId+GetNombreClase(TablaBase.ToString())+"Actual\", str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\thttpSession.removeAttribute(\""+strId+GetNombreClase(TablaBase.ToString())+"Actual\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\thttpSession.removeAttribute(\"accionMantenimiento\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t}";
					strFuncionesAccionesImagen+=" catch(Exception e)";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tString strMensaje=e.getMessage();";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t\tthrow new Exception(\"FOTO:\"+e.getMessage());";						             	
					strFuncionesAccionesImagen+="\r\n\t\t\t\t}";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t/*mensaje=new Mensaje(\"Auxiliar\",\"Registro de sesion de imagen\",\"Mantenimiento"+GetNombreClase(TablaBase.ToString())+".jsp\",MensajeGrupo.NONE);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tsXml = mensaje.toNewXmlMensaje();";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpServletResponse.setContentType(\"text/xml\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpServletResponse.getWriter().write(sXml);*/";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\thttpServletResponse.sendRedirect(Constantes.getSCarpetaPaginas()+\"/"+GetRelativePathNavegacionFromTableFromPropertiesC(TablaBase)+"Mantenimiento"+GetNombreClase(TablaBase.ToString())+".jsp\");";
					strFuncionesAccionesImagen+="\r\n\r\n\t\t\t\t//requestDispatcher=httpServletRequest.getRequestDispatcher(Constantes.getSCarpetaPaginas()+\"/"+GetRelativePathNavegacionFromTableFromPropertiesC(TablaBase)+"Mantenimiento"+GetNombreClase(TablaBase.ToString())+".jsp\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t//requestDispatcher.forward(httpServletRequest, httpServletResponse);";
					strFuncionesAccionesImagen+="\r\n\t\t\t}";
					strFuncionesAccionesImagen+=" else if(sAccionMantenimiento.equals(\""+GetNombreClaseObjeto(TablaBase.ToString())+"ActualCargarImagen"+GetNombreColumnaClaseC(columnSchema)+"\"))";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tString str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual=\"0\";";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tstr"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual=httpServletRequest.getParameter(\"hdnIdActual\");";		
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpSession.setAttribute(\"ultimaBusqueda"+GetNombreClase(TablaBase.ToString())+"\", \"accionBusqueda=Por"+strIdGetSet+"&"+strId+GetNombreClase(TablaBase.ToString())+"=\"+str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpSession.setAttribute(\"ultimaBusqueda"+GetNombreClase(TablaBase.ToString())+"Anterior\", httpServletRequest.getParameter(\"ultimaBusquedaAnterior\"));";
				
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpSession.setAttribute(\""+strId+GetNombreClase(TablaBase.ToString())+"Actual\", str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpSession.setAttribute(\""+strId+GetNombreClase(TablaBase.ToString())+"ActualMostrarImagen\", str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\t"+GetNombreClaseObjeto(TablaBase.ToString())+"Logic.getEntity(Long.parseLong(str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual));";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpSession.setAttribute(\"Descripcion"+GetNombreClase(TablaBase.ToString())+"ActualMostrarImagen\", "+GetNombreClaseObjeto(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablaBase.ToString())+"()"+GetDescripcionComboColumnFromProperties(TablaBase)+");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpSession.setAttribute(\"accionMantenimiento\", \"cargarImagen"+GetNombreClase(TablaBase.ToString())+GetNombreColumnaClaseC(columnSchema)+"\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tmensaje=new Mensaje(\"Auxiliar\",\"Registro de sesion de imagen\",Constantes.getSCarpetaPaginas()+\"/"+GetRelativePathNavegacionFromTableFromPropertiesC(TablaBase)+"Mantenimiento"+GetNombreClase(TablaBase.ToString())+GetNombreColumnaClaseC(columnSchema)+"Imagen.jsp\",MensajeGrupo.NONE);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tsXml = mensaje.toNewXmlMensaje();";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpServletResponse.setContentType(\"text/xml\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpServletResponse.getWriter().write(sXml);";
					strFuncionesAccionesImagen+="\r\n\t\t\t}";
					strFuncionesAccionesImagen+=" else if(sAccionMantenimiento.equals(\""+GetNombreClaseObjeto(TablaBase.ToString())+"ActualMostrarImagen"+GetNombreColumnaClaseC(columnSchema)+"\"))";
					strFuncionesAccionesImagen+=" {";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tString str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual=\"0\";";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tstr"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual=httpServletRequest.getParameter(\"hdnIdActual\").trim();";					  
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpSession.setAttribute(\""+strId+GetNombreClase(TablaBase.ToString())+"ActualMostrarImagen\", str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual);";
					
					strFuncionesAccionesImagen+="\r\n\t\t\t\t"+GetNombreClaseObjeto(TablaBase.ToString())+"Logic.getEntity(Long.parseLong(str"+strIdGetSet+GetNombreClase(TablaBase.ToString())+"Actual));";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpSession.setAttribute(\"Descripcion"+GetNombreClase(TablaBase.ToString())+"ActualMostrarImagen\", "+GetNombreClaseObjeto(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablaBase.ToString())+"()"+GetDescripcionComboColumnFromProperties(TablaBase)+");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tmensaje=new Mensaje(\"Auxiliar\",\"Registro de sesion de imagen\",Constantes.getSCarpetaPaginas()+\"/"+GetRelativePathNavegacionFromTableFromPropertiesC(TablaBase)+GetNombreClase(TablaBase.ToString())+GetNombreColumnaClaseC(columnSchema)+"ImagenMostrar.jsp\",MensajeGrupo.NONE);";
					strFuncionesAccionesImagen+="\r\n\t\t\t\tsXml = mensaje.toNewXmlMensaje();";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpServletResponse.setContentType(\"text/xml\");";
					strFuncionesAccionesImagen+="\r\n\t\t\t\thttpServletResponse.getWriter().write(sXml);";
					strFuncionesAccionesImagen+="\r\n\t\t\t}";
				}
			}
			
	return strFuncionesAccionesImagen;
}


		
public String GetXmlBusquedasIndicesTablasCompuestos() 
		{
			String strFuncion=string.Empty;
			String strTablaClaseRelacionada=string.Empty;
			String strInitFuncion="";
			
			
			String strIfFuncion=string.Empty;
			strIfFuncion=" else if(sAccionBusqueda==\"{0}\") {";
			
			String strFuncionBusqueda="";
			
			String strDefinicionVariables="";
			String strUsoVariables="";
			
			String strXmlFuncion=string.Empty;
			
			String strParametroPadre="\r\n\t\t\t\tLong big"+strIdGetSet+GetNombreClaseC(TablaBase.ToString())+ "=Long.parseLong(httpServletRequest.getParameter(\""+strIdGetSet+GetNombreClaseC(TablaBase.ToString())+"\"));";

			String strFuncionTodos=string.Empty;
			
			if(TablasBaseCompuestoDetalle!=null&&TablasBaseCompuestoJunction!=null&&TablasBaseCompuestoDetalle.Count==TablasBaseCompuestoJunction.Count&&TablasBaseCompuestoJunction.Count>0)
			{
				
				for(int i=0;i<TablasBaseCompuestoJunction.Count;i++)
				{
					
					strFuncionTodos=" else if(sAccionBusqueda.equals(\""+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+"Todos\"))";
					strFuncionTodos+=" {\r\n\t\t\t\t"+strParametroPadre+"\r\n\t\t\t\t";					
					strFuncionTodos+=GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+"sTodos("+GetNombreOrderColumnFromPropertiesC(TablaBase)+"sFinalQueryPaginacion,big"+strIdGetSet+GetNombreClaseC(TablaBase.ToString())+");";
					strFuncionTodos+="\r\n\t\t\t\tsXml ="+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.getXml"+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+"s();";
						
					strFuncionTodos+="\r\n\r\n\t\t\t\tif("+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"s()==null||"+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"s().size()==0)";
					strFuncionTodos+=" {";
					strFuncionTodos+="\r\n\t\t\t\t\tsXml =Mensaje.getMensajeGeneralNoExisteBusqueda(\""+GetNombreClaseC(TablaBase.ToString())+"\");";
					strFuncionTodos+="\r\n\t\t\t\t}";
					
					strFuncionTodos+="\r\n\r\n\t\t\t\thttpServletResponse.setContentType(\"text/xml\");";
					strFuncionTodos+="\r\n\t\t\t\thttpServletResponse.getWriter().write(sXml);";
					strFuncionTodos+="\r\n\t\t\t}";
					
					
			
					strXmlFuncion="\r\n\t\t\t\tsXml ="+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.getXml"+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+"s();";
					
					strXmlFuncion+="\r\n\r\n\t\t\t\t\tif("+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+"s()==null||"+GetNombreClaseObjetoC(TablaBase.ToString())+ "Logic.get"+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+"s().size()==0)";
					strXmlFuncion+=" {\r\n\t\t\t\t\t\tsXml =Mensaje.getMensajeGeneralNoExisteBusqueda(\""+GetNombreClaseC(TablaBase.ToString())+"\");\r\n\t\t\t\t\t}";
					
					strXmlFuncion+="\r\n\r\n\t\t\thttpServletResponse.setContentType(\"text/xml\");";
					strXmlFuncion+="\r\n\t\t\thttpServletResponse.getWriter().write(sXml);";
					
					String strXmlFuncionObjeto=string.Empty;
					
					strXmlFuncionObjeto="\r\n\r\n\t\t\t\t\tif("+GetNombreClaseObjetoC(TablaBase.ToString())+ "Logic.get"+GetNombreClase(TablaBase.ToString())+"()!=null&&"+GetNombreClaseObjetoC(TablaBase.ToString())+ "Logic.get"+GetNombreClase(TablaBase.ToString())+"().get"+strIdGetSet+"()!=0) {";
					strXmlFuncionObjeto+="\r\n\t\t\t\t\t\tsXml ="+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.getXml"+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+"();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{";
					strXmlFuncionObjeto+="\r\n\t\t\t\t\t\tsXml =Mensaje.getMensajeGeneralNoExisteBusqueda(\""+ GetNombreClase(TablaBase.ToString())+ "\");\r\n\t\t\t\t\t}";
					
					
					//strXmlFuncion+="\r\n\r\n\t\t\t\t\tif("+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"()==null&&sXmlMensajeMantenimiento==\"\")";
					//strXmlFuncion+="\r\n\t\t\t\t\t{\r\n\t\t\t\t\tsXml =Mensaje.getMensajeGeneralNoExisteBusqueda(\""+GetNombreClaseC(TablaBase.ToString())+"\");\r\n\t\t\t\t\t}";
				
					strXmlFuncionObjeto+="\r\n\r\n\t\t\thttpServletResponse.setContentType(\"text/xml\");";
					strXmlFuncionObjeto+="\r\n\t\t\thttpServletResponse.getWriter().write(sXml);";
						
								
					foreach(IndexSchema indexSchema in TablasBaseCompuestoDetalle[i].Indexes)
					{
						if(!indexSchema.IsPrimaryKey)
						{
							
							if(indexSchema.IsUnique)
							{
								continue;
								/*
								strFuncionBusqueda="\r\n\r\n\t\t\t\t"+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+indexSchema.Name+"(";
								strIfFuncion="\r\n\t\t\telse if(sAccionBusqueda.equals(\""+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+indexSchema.Name+"\"))\r\n\t\t\t{";
								*/
							}
							else
							{
								if(indexSchema.Name.Contains("Busqueda")|indexSchema.Name.Contains("FK"))
								{
								strFuncionBusqueda="\r\n\r\n\t\t\t\t"+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+"s"+indexSchema.Name+"("+GetNombreOrderColumnFromPropertiesC(TablaBase)+"sFinalQueryPaginacion,big"+strIdGetSet+GetNombreClaseC(TablaBase.ToString())+",";
								strIfFuncion=" else if(sAccionBusqueda.equals(\""+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+indexSchema.Name+"\")) {";
								
								}
								else
								{
								strFuncionBusqueda="\r\n\r\n\t\t\t\t"+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+GetNombreClase(TablasBaseCompuestoDetalle[i].ToString())+strClaseAuxiliar+"s"+indexSchema.Name+"(";
								strIfFuncion=" else if(sAccionBusqueda.equals(\""+strClaseAuxiliar+GetNombreClase(TablasBaseCompuestoJunction[i].ToString())+indexSchema.Name+"\")) {";	
								}
							}
							
							
							strIfFuncion+=strParametroPadre;
							
							int count=1;
							strDefinicionVariables="";
							strUsoVariables="";							
							//strFuncionBusqueda="";
									foreach(MemberColumnSchema memberColumnSchema in indexSchema.MemberColumns)
									{
																						
									if(!(indexSchema.Name.Contains("BusquedaMayor")||indexSchema.Name.Contains("BusquedaMayorIgual")||indexSchema.Name.Contains("BusquedaMenor")||indexSchema.Name.Contains("BusquedaMenorIgual")||indexSchema.Name.Contains("BusquedaRango")||indexSchema.Name.Contains("BusquedaRangoIgual")))
										{								
											strDefinicionVariables+="\r\n\t\t\t\t"+GetTipoColumnaClaseC(memberColumnSchema.Column)+" "+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"=null;";
									
											strDefinicionVariables+="\r\n\r\n\t\t\t\tif(httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name)+"\")!=null)";
											strDefinicionVariables+=" {";
											strDefinicionVariables+="\r\n\t\t\t\t\t"+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"="+GetTipoColumnaParse(memberColumnSchema.Column,"httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name)+"\")")+";";
												
											strDefinicionVariables+="\r\n\t\t\t\t}";
									
																						
											strUsoVariables+=GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column); 
											
											if(!indexSchema.MemberColumns.Count.Equals(count))
											{
												strUsoVariables+=",";	
											}
										}
										else
										{
											if(!indexSchema.Name.Contains("BusquedaRango"))
											{
												strDefinicionVariables+="\r\n\t\t\t\t"+GetTipoColumnaClaseC(memberColumnSchema.Column)+" "+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"="+GetTipoColumnaParse(memberColumnSchema.Column,"httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name)+"\")")+";";
												strUsoVariables+=GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column); 									
											}
											else
											{
												strDefinicionVariables+="\r\n\t\t\t\t"+GetTipoColumnaClaseC(memberColumnSchema.Column)+" "+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"Inicial="+GetTipoColumnaParse(memberColumnSchema.Column,"httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name).Replace(memberColumnSchema.Column.Name+indexSchema.Name+"",memberColumnSchema.Column.Name+indexSchema.Name+"Inicial\"")+")")+";";
												strUsoVariables+=GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"Inicial"; 									
												
												strUsoVariables+=",";	
												
												strDefinicionVariables+="\r\n\t\t\t\t"+GetTipoColumnaClaseC(memberColumnSchema.Column)+" "+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"Final="+GetTipoColumnaParse(memberColumnSchema.Column,"httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name).Replace(memberColumnSchema.Column.Name+indexSchema.Name+"",memberColumnSchema.Column.Name+indexSchema.Name+"Final\"")+")")+";";
												strUsoVariables+=GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"Final"; 									
											}								
										}
										count++;
									}
									strFuncionBusqueda+=strUsoVariables+");";
									
							if(indexSchema.IsUnique)
							{
									strInitFuncion+=strIfFuncion+strDefinicionVariables+strFuncionBusqueda+strXmlFuncionObjeto+"\r\n\r\n\t\t\t}";																																		
							}
							else
							{
									strInitFuncion+=strIfFuncion+strDefinicionVariables+strFuncionBusqueda+strXmlFuncion+"\r\n\r\n\t\t\t}";																																		
							}
						}
						
					}
					
					strInitFuncion=strFuncionTodos+strInitFuncion;
					
				}
			}
			
			return  strInitFuncion;
		}

public String GetMaintenanceTablasClasesRelacionadas() 
		{
			String strTablaClaseRelacionada=string.Empty;
			System.Collections.Hashtable tablasRelacionadas=GetTablasRelacionadas(TablaBase);
										 			
			foreach(CollectionInfo collectionInfo in tablasRelacionadas.Values)
			{
				if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne)
				{
					strTablaClaseRelacionada+="\r\n\t"+GetNombreClaseC("dbo."+collectionInfo.SecondaryTable)+ " TR_"+GetNombreClaseC("dbo."+collectionInfo.SecondaryTable)+";";
				}
				else if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToMany)
				{
					strTablaClaseRelacionada+="\r\n\t"+strTypeCollection+"<"+GetNombreClaseC("dbo."+collectionInfo.SecondaryTable)+"> TR_"+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable)+ "s;";
				}
			}
								
			return strTablaClaseRelacionada; 
		}

public String GetMaintenanceTablasClasesRelacionadasRelaciones() 
		{
			String strTablaClaseRelacionada="";
			String strFuncionInit="save"+GetNombreClase(TablaBase.ToString())+"Relaciones(iIdUsuarioSesion,true,httpServletRequest.getRemoteHost(),httpServletRequest.getRemoteAddr(),"+GetNombreClaseObjetoC(TablaBase.ToString());
			String strFuncionEnd=");";
			
			System.Collections.Hashtable tablasRelacionadas=GetTablasRelacionadas(TablaBase);
										 			
			foreach(CollectionInfo collectionInfo in tablasRelacionadas.Values)
			{
				if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne)
				{
					strTablaClaseRelacionada+=","+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable);
				}
				else if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToMany)
				{
					strTablaClaseRelacionada+=","+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable)+ "s";
				}
			}
			
			strTablaClaseRelacionada=strFuncionInit+strTablaClaseRelacionada+strFuncionEnd;
			return strTablaClaseRelacionada; 
		}
		
public String GetXmlBusquedasIndicesTablas() 
		{
			String strFuncion=string.Empty;
			String strTablaClaseRelacionada=string.Empty;
			String strInitFuncion="";
			
			
			String strIfFuncion=string.Empty;
			strIfFuncion=" else if(sAccionBusqueda==\"{0}\") {";
			
			String strFuncionBusqueda="";
			String strFuncionBusqueda2="";
			
			String strDefinicionVariables="";
			String strUsoVariables="";
			
			String strXmlFuncion=string.Empty;
			
			String strFuncionLogic="";
			
			
			strXmlFuncion="\r\n\t\t\t\tsXml ="+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.getXml"+GetNombreClaseC(TablaBase.ToString())+"s();";
			
			strXmlFuncion+="\r\n\r\n\t\t\t\t\tif("+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"s()==null||"+GetNombreClaseObjetoC(TablaBase.ToString())+ "Logic.get"+GetNombreClaseC(TablaBase.ToString())+"s().size()==0)";
			strXmlFuncion+=" {\r\n\t\t\t\t\t\tsXml =Mensaje.getMensajeGeneralNoExisteBusqueda(\""+GetNombreClaseC(TablaBase.ToString())+"\");\r\n\t\t\t\t\t}";
			
			strXmlFuncion+="\r\n\r\n\t\t\t\tif(sgenerarReporte!=\"\"&&sgenerarReporte!=null) {";
			
			strXmlFuncion+="\r\n\t\t\t\t\tif(isMostrarTodosResultadosReporte) {";
			strXmlFuncion+="\r\n\t\t\t\t\t\t"+GetNombreClaseObjetoC(TablaBase.ToString())+"s="+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"s();";						
			strXmlFuncion+="\r\n\t\t\t\t\t\t\t\txyzFuncionBusqueda";
			strXmlFuncion+="\r\n\t\t\t\t\t}";	
			
			
			strXmlFuncion+="\r\n\r\n\t\t\t\t\tgenerarReporte"+GetNombreClase(TablaBase.ToString())+"s(httpServletRequest,httpServletResponse,\"xyzTipoBusqueda\","+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"s(),isReporteRelaciones,sDetalleReporte, "+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic,jasperPrint,sgenerarReporte);";
			
			strXmlFuncion+="\r\n\r\n\t\t\t\t\tif(isMostrarTodosResultadosReporte) {";
			strXmlFuncion+="\r\n\t\t\t\t\t\t"+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.set"+GetNombreClaseC(TablaBase.ToString())+"s("+GetNombreClaseObjetoC(TablaBase.ToString())+"s);";
			strXmlFuncion+="\r\n\t\t\t\t\t}\r\n\t\t\t\t}";	
			
			strXmlFuncion+="\r\n\r\n\t\t\t\thttpServletResponse.setContentType(\"text/xml\");";
			strXmlFuncion+="\r\n\t\t\t\thttpServletResponse.getWriter().write(sXml);";
			
			String strXmlFuncionObjeto=string.Empty;
			
			strXmlFuncionObjeto="\r\n\r\n\t\t\t\t\tif("+GetNombreClaseObjetoC(TablaBase.ToString())+ "Logic.get"+GetNombreClase(TablaBase.ToString())+"()!=null&&"+GetNombreClaseObjetoC(TablaBase.ToString())+ "Logic.get"+GetNombreClase(TablaBase.ToString())+"().get"+strIdGetSet+"()!=0) {";
			strXmlFuncionObjeto+="\r\n\t\t\t\t\t\tsXml ="+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.getXml"+GetNombreClaseC(TablaBase.ToString())+"();\r\n\t\t\t\t\t} else {";
			strXmlFuncionObjeto+="\r\n\t\t\t\t\t\tsXml =Mensaje.getMensajeGeneralNoExisteBusqueda(\""+ GetNombreClase(TablaBase.ToString())+ "\");\r\n\t\t\t\t\t}";
			
			
			//strXmlFuncion+="\r\n\r\n\t\t\t\t\tif("+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"()==null&&sXmlMensajeMantenimiento==\"\")";
			//strXmlFuncion+="\r\n\t\t\t\t\t{\r\n\t\t\t\t\tsXml =Mensaje.getMensajeGeneralNoExisteBusqueda(\""+GetNombreClaseC(TablaBase.ToString())+"\");\r\n\t\t\t\t\t}";
		
			strXmlFuncionObjeto+="\r\n\r\n\t\t\t\thttpServletResponse.setContentType(\"text/xml\");";
			strXmlFuncionObjeto+="\r\n\t\t\t\thttpServletResponse.getWriter().write(sXml);";
				
						
			foreach(IndexSchema indexSchema in TablaBase.Indexes)
			{
				
				if(!indexSchema.IsPrimaryKey)
				{
					
					strFuncionBusqueda2="\r\n\t\t\t\tsDetalleReporte="+GetNombreClase(TablaBase.ToString())+"ConstantesFunciones.getDetalleIndice"+indexSchema.Name+"(";
					
					if(indexSchema.IsUnique)
					{
						
						strFuncionBusqueda="\r\n\r\n\t\t\t\t"+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+indexSchema.Name+"(";
						strIfFuncion=" else if(sAccionBusqueda.equals(\""+indexSchema.Name+"\")) {";
					}
					else
					{
						if(indexSchema.Name.Contains("Busqueda")||indexSchema.Name.Contains("FK"))
						{
						strFuncionBusqueda="\r\n\r\n\t\t\t\t"+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"s"+indexSchema.Name+"("+GetNombreOrderColumnFromPropertiesC(TablaBase)+"sFinalQueryPaginacion,";
						strIfFuncion=" else if(sAccionBusqueda.equals(\""+indexSchema.Name+"\")) {";
						
						}
						else
						{
						strFuncionBusqueda="\r\n\r\n\t\t\t\t"+GetNombreClaseObjetoC(TablaBase.ToString())+"Logic.get"+GetNombreClaseC(TablaBase.ToString())+"s"+indexSchema.Name+"(";
						strIfFuncion=" else if(sAccionBusqueda.equals(\""+indexSchema.Name+"\")) {";	
						}
					}
					
					int count=1;
					strDefinicionVariables="";
					strUsoVariables="";							
					//strFuncionBusqueda="";
							foreach(MemberColumnSchema memberColumnSchema in indexSchema.MemberColumns)
							{
																				
							if(!(indexSchema.Name.Contains("BusquedaMayor")||indexSchema.Name.Contains("BusquedaMayorIgual")||indexSchema.Name.Contains("BusquedaMenor")||indexSchema.Name.Contains("BusquedaMenorIgual")||indexSchema.Name.Contains("BusquedaRango")||indexSchema.Name.Contains("BusquedaRangoIgual")))
								{								
									strDefinicionVariables+="\r\n\t\t\t\t"+GetTipoColumnaClaseC(memberColumnSchema.Column)+" "+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"=null;";
									
									strDefinicionVariables+="\r\n\r\n\t\t\t\tif(httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name)+"\")!=null)";
									strDefinicionVariables+=" {";
									strDefinicionVariables+="\r\n\t\t\t\t\t"+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"="+GetTipoColumnaParse(memberColumnSchema.Column,"httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name)+"\")")+";";
										
									strDefinicionVariables+="\r\n\t\t\t\t}";
									
									if(indexSchema.Name.Contains(strFK+"_"))
									{
										strDefinicionVariables+="\r\n\r\n\t\t\t\tif(httpSession.getAttribute(\""+memberColumnSchema.Column.Name+"Actual\")!=null)";
										strDefinicionVariables+=" {";
										strDefinicionVariables+="\r\n\t\t\t\t\t"+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"=("+GetTipoColumnaClaseC(memberColumnSchema.Column)+")httpSession.getAttribute(\""+memberColumnSchema.Column.Name+"Actual\");";
										strDefinicionVariables+="\r\n\t\t\t\t\thttpSession.removeAttribute(\""+memberColumnSchema.Column.Name+"Actual\");";
										
										strDefinicionVariables+="\r\n\t\t\t\t}";
									}
									
									strUsoVariables+=GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column); 
									
									if(!indexSchema.MemberColumns.Count.Equals(count))
									{
										strUsoVariables+=",";	
									}
								}
								else
								{
									if(!indexSchema.Name.Contains("BusquedaRango"))
									{
										strDefinicionVariables+="\r\n\t\t\t\t"+GetTipoColumnaClaseC(memberColumnSchema.Column)+" "+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"="+GetTipoColumnaParse(memberColumnSchema.Column,"httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name)+"\")")+";";
										strUsoVariables+=GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column); 									
									}
									else
									{
										strDefinicionVariables+="\r\n\t\t\t\t"+GetTipoColumnaClaseC(memberColumnSchema.Column)+" "+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"Inicial="+GetTipoColumnaParse(memberColumnSchema.Column,"httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name).Replace(memberColumnSchema.Column.Name+indexSchema.Name+"",memberColumnSchema.Column.Name+indexSchema.Name+"Inicial\"")+")")+";";
										strUsoVariables+=GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"Inicial"; 									
										
										strUsoVariables+=",";	
										
										strDefinicionVariables+="\r\n\t\t\t\t"+GetTipoColumnaClaseC(memberColumnSchema.Column)+" "+GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"Final="+GetTipoColumnaParse(memberColumnSchema.Column,"httpServletRequest.getParameter(\""+GetNameControlHtmlBusqueda(memberColumnSchema.Column,indexSchema.Name).Replace(memberColumnSchema.Column.Name+indexSchema.Name+"",memberColumnSchema.Column.Name+indexSchema.Name+"Final\"")+")")+";";
										strUsoVariables+=GetPrefijoTipoC(memberColumnSchema.Column)+GetNombreColumnaClaseC(memberColumnSchema.Column)+"Final"; 									
									}								
								}
								count++;
							}
							strFuncionBusqueda2+=strUsoVariables+");\r\n";
							strFuncionBusqueda+=strUsoVariables+");";
							
					if(indexSchema.IsUnique)
					{
							strInitFuncion+=strIfFuncion+strDefinicionVariables+strFuncionBusqueda+strFuncionBusqueda2+strXmlFuncionObjeto+"\r\n\r\n\t\t\t}";																																		
					}
					else
					{
							strInitFuncion+=strIfFuncion+strDefinicionVariables+strFuncionBusqueda+strFuncionBusqueda2+strXmlFuncion.Replace("xyzTipoBusqueda",indexSchema.Name).Replace("xyzFuncionBusqueda",strFuncionBusqueda.Replace("sFinalQueryPaginacion","\"\"").Replace("\r\n\r\n","\r\n\t\t"))+"\r\n\r\n\t\t\t}";																																		
					}
				}
			}								
			return  strInitFuncion;
		}
		
public string GetParametroFuncionNuevoClase(ColumnSchema column)
{		String strParamtro=string.Empty;	
		
		if(column.Name.Equals(strId)||column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired)|| column.Name.Equals(strVersionRow))
		{
			return strParamtro;
		}
		strParamtro=GetPrefijoTipoC(column)+GetNombreColumnaClaseC(column);
		return strParamtro;
}
public string GetParametroFuncionActualizarClass(ColumnSchema column)
{		String strParamtro=string.Empty;	
		
		if(/*column.Name.Equals(strId)||*/column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired))
		{
			return strParamtro;
		}
		strParamtro=GetPrefijoTipoC(column)+GetNombreColumnaClaseC(column);
		return strParamtro;
}
public string GetParametroFuncionActualizarClase(ColumnSchema column)
{		String strParamtro=string.Empty;	

		if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired)|| column.Name.Equals(strVersionRow))
		{
			return strParamtro;
		}
		if(!column.Name.Equals(strId))
		{
		strParamtro=GetPrefijoTipoC(column)+GetNombreColumnaClaseC(column);		
		}
		else
		{
		strParamtro=strId;			
		}
		return strParamtro;
}
public string GetSetVariablesFormularioNuevo(ColumnSchema column,String table)
{
	String strTipo=GetTipoColumnaClaseC(column);	
	String strPrefijo=" "+GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);
	
	String strIfElse="\r\nif(httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\")== null|| httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\")==\"\")\r\n{\r\n";
	strIfElse+=strPrefijo+strColumna+"=null;\r\n}\r\nelse\r\n{\r\n";	
	
	if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired)||column.Name.Equals(strId)||column.Name.Equals(strVersionRow))
	{
			return string.Empty;
	}
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	return strIfElse+ strPrefijo+strColumna+"="+GetTipoColumnaParse(column,"httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\"")+");\r\n}";
}
public string GetSetVariablesFormulario(ColumnSchema column,String table)
{
	String strTipo=GetTipoColumnaClaseC(column);	
	String strPrefijo=" "+GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);	
	String strIfElse="\r\nif(httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\")== null||httpServletRequest.getParameter(\""+GetNameControlHtml(column) + "\")==\"\")\r\n{\r\n";
	strIfElse+=strPrefijo+strColumna+"=null;\r\n}\r\nelse\r\n{\r\n";	
	
	if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired))
	{
			return string.Empty;
	}
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	return strIfElse+strPrefijo+strColumna+"="+GetTipoColumnaParse(column,"httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\"")+");\r\n}";
}

public string GetSetVariablesFormularioContador(ColumnSchema column,String table)
{
	String strTipo=GetTipoColumnaClaseC(column);	
	String strPrefijo=" "+GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);	
	String strIfElse="\r\n\t\t\t\t\tif(httpServletRequest.getParameter(\""+column.Name +GetNombreClaseC(TablaBase.ToString())+"\"+i)== null||httpServletRequest.getParameter(\""+column.Name+GetNombreClaseC(TablaBase.ToString()) + "\"+i)==\"\"){";
	strIfElse+=strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+"=null;}\r\n\t\t\t\t\telse{";	
	
	if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired))
	{
			return string.Empty;
	}
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	String strReplace="";
	
	if(column.DataType==DbType.Date||column.DataType==DbType.DateTime)
	{
		strReplace=".replace(\"/\", \"-\")";
	}
	
	return strIfElse+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+"="+GetTipoColumnaParse(column,"httpServletRequest.getParameter(\""+column.Name+GetNombreClaseC(TablaBase.ToString()) +"\"+i)"+strReplace)+";}";
}

public string GetSetVariablesFormularioContadorParaBorrar(ColumnSchema column,String table)
{
	String strTipo=GetTipoColumnaClaseC(column);	
	String strPrefijo=" "+GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);	
	String strIfElse="\r\n\t\t\t\t\tif(httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\"+i.toString()+\"ParaBorrar\")== null||httpServletRequest.getParameter(\""+GetNameControlHtml(column) + "\"+i.toString()+\"ParaBorrar\")==\"\"){";
	strIfElse+=strPrefijo+strColumna+"=null;}\r\n\t\t\t\t\telse{";	
	
	if(!column.Name.Equals(strId))
	{
			return string.Empty;
	}
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	return strIfElse+strPrefijo+strColumna+"="+GetTipoColumnaParse(column,"httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\"+i.toString()+\"ParaBorrar\"")+");}";
}

public string GetSetRequestVariables(ColumnSchema column,String table)
{
	String strInit="httpServletRequest.setAttribute(\"";	
	String strPrefijo=" "+GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);	
	
	if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired)|| column.Name.Equals(strVersionRow))
	{
			return string.Empty;
	}
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	return strInit+strColumna+"\","+GetNombreCompletoColumnaClaseSinPrefijoTablaC(column)+GetTipoColumnaToString(column)+");";
}
public string GetSetVariables(ColumnSchema column,String table)
{
	String strTipo=GetTipoColumnaClaseC(column);	
	String strPrefijo=" "+GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);	
	
	if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired)|| column.Name.Equals(strVersionRow))
	{
			return string.Empty;
	}
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	return strPrefijo+strColumna+"="+GetNombreClaseObjetoC(table)+"Logic.get"+GetNombreClaseC(table)+"().get"+GetNombreCompletoColumnaClaseC(column)+"();";
}
public string GetNombreVariables(ColumnSchema column)
{
	String strTipo=GetTipoColumnaClaseC(column);	
	String strPrefijo=" "+GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);	
	
	if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired))
	{
			return string.Empty;
	}
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	return strTipo+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+";";
}



public string GetNombreClaseObjeto(string strTablaBase)
{		
		return GetNombreClaseObjetoC(strTablaBase);
}
public string GetNombreClase(string strTablaBase)
{		
		return GetNombreClaseC(strTablaBase);
}

public string GetSetVariablesToObjetoLogicNuevo(ColumnSchema column)
{
	String strTipo=GetTipoColumnaClaseC(column);	
	String strPrefijo=GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);	
	String strIfElse="\r\nif(httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\"+i.tToString())== null||httpServletRequest.getParameter(\""+GetNameControlHtml(column) + "\"+i.toString())==\"\")\r\n{\r\n";
	strIfElse+=strPrefijo+strColumna+"=null;\r\n}\r\nelse\r\n{\r\n";	
	
	if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired)|| column.Name.Equals(strId))
	{
			return string.Empty;
	}
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	//return  GetNombreClaseObjeto(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablaBase.ToString())+"().setField_"+strPrefijo+ strColumna +"("+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+");";
	return  GetNombreClaseObjeto(TablaBase.ToString())+".setField_"+strPrefijo+ strColumna +"("+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+");";
}

public string GetSetVariablesToObjetoLogicActualizar(ColumnSchema column)
{
	String strTipo=GetTipoColumnaClaseC(column);	
	String strPrefijo=GetPrefijoTipoC(column);	
	String strColumna=GetNombreColumnaClaseC(column);	
	String strIfElse="\r\nif(httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\"+i.tToString())== null||httpServletRequest.getParameter(\""+GetNameControlHtml(column) + "\"+i.toString())==\"\")\r\n{\r\n";
	strIfElse+=strPrefijo+strColumna+"=null;\r\n}\r\nelse\r\n{\r\n";	
	
	if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired))
	{
			return string.Empty;
	}
		
	if(column.Name.Equals(strId))
	{
		//return  GetNombreClaseObjeto(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablaBase.ToString())+"().set"+strIdGetSet+"("+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+");";
		return  GetNombreClaseObjeto(TablaBase.ToString())+".set"+strIdGetSet+"("+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+");";
	}
	if(column.Name.Equals(strVersionRow))
	{
		//return  GetNombreClaseObjeto(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablaBase.ToString())+"().set"+strVersionRowGetSet+"("+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+");";
		return  GetNombreClaseObjeto(TablaBase.ToString())+".set"+strVersionRowGetSet+"("+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+");";
	}
	//return  GetNombreClaseObjeto(TablaBase.ToString())+"Logic.get"+GetNombreClase(TablaBase.ToString())+"().setField_"+strPrefijo+ strColumna +"("+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+");";
	return  GetNombreClaseObjeto(TablaBase.ToString())+".setField_"+strPrefijo+ strColumna +"("+strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString())+");";
}

public String GetVariablesTablasClasesRelacionadas() 
		{
			String strTablaClaseRelacionada="";
			
			System.Collections.Hashtable tablasRelacionadas=GetTablasRelacionadas(TablaBase);
										 			
			foreach(CollectionInfo collectionInfo in tablasRelacionadas.Values)
			{
				if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne||collectionInfo.CollectionRelationshipType==RelationshipType.OneToMany)
				{
					if(TablaBase.Name!=collectionInfo.SecondaryTable)
					{
						strTablaClaseRelacionada+="\r\n\r\n\t\t "+GetNombreClaseC("dbo."+collectionInfo.SecondaryTable)+"Logic "+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable)+"Logic=null;";
						//strTablaClaseRelacionada+="\r\n\t"+GetNombreClase("dbo."+collectionInfo.SecondaryTable)+" "+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable+";");
						strTablaClaseRelacionada+="\r\n\t\t "+strTypeCollection+"<"+GetNombreClase("dbo."+collectionInfo.SecondaryTable)+"> "+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable)+"s=new "+strTypeNewCollection+"<"+GetNombreClase("dbo."+collectionInfo.SecondaryTable)+">"+strTypeNewCollectionEnd+";";
					}
				}
			}
			
			
			return strTablaClaseRelacionada; 
		}
		
public String GetVariablesNewTablasClasesRelacionadas() 
		{
			return "";
			
			String strTablaClaseRelacionada="";
			
			System.Collections.Hashtable tablasRelacionadas=GetTablasRelacionadas(TablaBase);
										 			
			foreach(CollectionInfo collectionInfo in tablasRelacionadas.Values)
			{
				if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne||collectionInfo.CollectionRelationshipType==RelationshipType.OneToMany)
				{
					strTablaClaseRelacionada+="\r\n\r\n\t\t\t"+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable)+"Logic=new "+GetNombreClase("dbo."+collectionInfo.SecondaryTable)+"Logic();";
					//strTablaClaseRelacionada+="\r\n\t\t\t"+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable+"")+"=new "+GetNombreClase("dbo."+collectionInfo.SecondaryTable)+"();";
					strTablaClaseRelacionada+="\r\n\t\t\t"+GetNombreClaseObjetoC("dbo."+collectionInfo.SecondaryTable)+"s=new "+strTypeNewCollection+"<"+GetNombreClase("dbo."+collectionInfo.SecondaryTable)+">"+strTypeNewCollectionEnd+";";
				}
			}
			
			
			return strTablaClaseRelacionada; 
		}

public String GetprocesarTablasClasesRelacionadas() 
		{
			String strTablaClaseRelacionada="";
			String strFuncionInit="";
			String strFuncionEnd="(httpServletRequest,httpServletResponse);\r\n\t\t\t\t}";
			
			System.Collections.Hashtable tablasRelacionadas=GetTablasRelacionadas(TablaBase);
			TableSchema tablaRelacionada;
			String strSufijo="";
			
			foreach(CollectionInfo collectionInfo in tablasRelacionadas.Values)
			{
				
				if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne)
				{
					tablaRelacionada=collectionInfo.SecondaryTableSchema;
					strSufijo="";
				}	
				else if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToMany)
				{
					
					tablaRelacionada=collectionInfo.SecondaryTableSchema;
					strSufijo="s";
				}
				else
				{
					continue;
				}
				
					strFuncionInit="\r\n\r\n\t\t\t\tif(httpServletRequest.getParameter(\"numeroDe"+GetNombreClaseC(tablaRelacionada.ToString())+"\")!=null) {\r\n\t\t\t\t\t"+GetNombreClaseObjetoC(tablaRelacionada.ToString())+strSufijo+"=procesar";
					strTablaClaseRelacionada+=strFuncionInit+GetNombreClaseC(tablaRelacionada.ToString())+"Relaciones"+strFuncionEnd;
				
			}
			
			return strTablaClaseRelacionada; 
		}

public String GetFuncionesMaintenanceTablasClasesRelacionadas() 
		{
			String strLastCode="";
			String strFuncionBody="";
			String strFuncionBody2="";
			TableSchema tablaRelacionada;
			
			String strVariables="";
			String strVariablesDocumento="";
			String strTablaClaseRelacionada="";
			String strFuncionInit="\r\n\r\n\tpublic void procesar"+GetNombreClase(TablaBase.ToString())+"Relaciones(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse) {";
			String strFuncionEnd="\r\n\t\t}\r\n\t} catch(Exception e) {\r\n\t\tthrow e;\r\n\t}";
			
			System.Collections.Hashtable tablasRelacionadas=GetTablasRelacionadas(TablaBase);
										 			
			foreach(CollectionInfo collectionInfo in tablasRelacionadas.Values)
			{
				
				if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne)
				{
					tablaRelacionada=collectionInfo.SecondaryTableSchema;
				}	
				else if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToMany)
				{
					
					tablaRelacionada=collectionInfo.SecondaryTableSchema;
				}
				else
				{
					continue;
				}
				
				//System.Windows.Forms.MessageBox.Show(tablaRelacionada.Name);
				
				if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne||collectionInfo.CollectionRelationshipType==RelationshipType.OneToMany)
				{
					strFuncionInit="\r\n\r\npublic "+strTypeCollection+"<"+GetNombreClase(tablaRelacionada.ToString())+"> procesar"+GetNombreClase(tablaRelacionada.ToString())+"Relaciones(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)throws Exception {";
					strFuncionInit+="\r\n\t"+strTypeCollection+"<"+GetNombreClase(tablaRelacionada.ToString())+"> "+ GetNombreClaseObjetoC(tablaRelacionada.ToString())+"s= new "+strTypeNewCollection+"<"+GetNombreClase(tablaRelacionada.ToString())+">"+strTypeNewCollectionEnd+";";
					strFuncionInit+="\r\n\t"+GetNombreClase(tablaRelacionada.ToString())+" "+ GetNombreClaseObjetoC(tablaRelacionada.ToString())+"= new "+GetNombreClase(tablaRelacionada.ToString())+"();";															
					strFuncionInit+="\r\n\ttry {";
					
					strFuncionBody="\r\n\r\n\t\tInteger iNumeroDe"+ GetNombreClase(tablaRelacionada.ToString())+"=0;";
					strFuncionBody+="\r\n\t\tBoolean isNew"+ GetNombreClase(tablaRelacionada.ToString())+"=false;";
					strFuncionBody+="\r\n\t\tBoolean isChanged"+ GetNombreClase(tablaRelacionada.ToString())+"=false;";
					strFuncionBody+="\r\n\t\tBoolean isDeleted"+ GetNombreClase(tablaRelacionada.ToString())+"=false;";
					
					//strFuncionBody+="\r\n\t\t"+ GetNombreClase(tablaRelacionada.ToString())+" "+GetNombreClaseObjetoC(tablaRelacionada.ToString())+"=null;";
					strFuncionBody+="\r\n\t\t"+GetNombreClase(tablaRelacionada.ToString())+"Logic "+ GetNombreClaseObjetoC(tablaRelacionada.ToString())+"Logic= new "+GetNombreClase(tablaRelacionada.ToString())+"Logic();";
						strFuncionBody+="\r\n\r\n\t\tif(httpServletRequest.getParameter(\"numeroDe"+ GetNombreClase(tablaRelacionada.ToString())+"\")!=null) {\r\n\t\t";
					strFuncionBody+="\tiNumeroDe"+GetNombreClase(tablaRelacionada.ToString())+"=Integer.parseInt(httpServletRequest.getParameter(\"numeroDe"+GetNombreClase(tablaRelacionada.ToString())+ "\"));\r\n\t\t}";
					
					strVariables=GetNombreVariables(tablaRelacionada);	
					
					
					strFuncionBody2="\r\n\r\n\t\tfor (int i = 0; i < iNumeroDe"+GetNombreClase(tablaRelacionada.ToString())+"; i++) {";
					strFuncionBody2+="\r\n\t\t\tisNew"+GetNombreClase(tablaRelacionada.ToString())+"=false;";
					strFuncionBody2+="\r\n\t\t\tisChanged"+GetNombreClase(tablaRelacionada.ToString())+"=false;";
					strFuncionBody2+="\r\n\t\t\tisDeleted"+GetNombreClase(tablaRelacionada.ToString())+"=false;";
	
					strFuncionBody2+="\r\n\r\n\t\t\tisNew"+GetNombreClase(tablaRelacionada.ToString())+"=Boolean.parseBoolean(httpServletRequest.getParameter(\"isNew"+GetNombreClase(tablaRelacionada.ToString())+"\"+i));";
					strFuncionBody2+="\r\n\t\t\tisChanged"+GetNombreClase(tablaRelacionada.ToString())+"=Boolean.parseBoolean(httpServletRequest.getParameter(\"isChanged"+GetNombreClase(tablaRelacionada.ToString())+"\"+i));";
					strFuncionBody2+="\r\n\t\t\tisDeleted"+GetNombreClase(tablaRelacionada.ToString())+"=Boolean.parseBoolean(httpServletRequest.getParameter(\"isDeleted"+GetNombreClase(tablaRelacionada.ToString())+"\"+i));";
					
					strFuncionBody2+="\r\n\r\n\t\t\tif(isNew"+GetNombreClase(tablaRelacionada.ToString())+"==false&&isChanged"+GetNombreClase(tablaRelacionada.ToString())+"==false&&isDeleted"+GetNombreClase(tablaRelacionada.ToString())+"==false) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}";
					//strFuncionBody2+="\r\n\r\n\t\t\t"+GetNombreClase(tablaRelacionada.ToString())+" "+GetNombreClaseObjeto(tablaRelacionada.ToString())+"=null;";
					
					strVariablesDocumento=GetSetVariablesFormularioContador(tablaRelacionada,TablaBase.ToString());
					
					strLastCode="\r\n\r\n\r\n\t\t\tif(isNew"+GetNombreClase(tablaRelacionada.ToString())+") {\r\n\t\t\t\t"+GetNombreClaseObjeto(tablaRelacionada.ToString())+"=new "+GetNombreClase(tablaRelacionada.ToString())+"();";
					strLastCode+=GetSetVariablesToObjetoLogicNuevo(tablaRelacionada);
					strLastCode+="\r\n\t\t\t} else {\r\n\t\t\t\t"+GetNombreClaseObjeto(tablaRelacionada.ToString())+"Logic.getEntity("+GetNombreIdVariable(tablaRelacionada)+");\r\n\t\t\t\t"+GetNombreClaseObjeto(tablaRelacionada.ToString())+"="+GetNombreClaseObjeto(tablaRelacionada.ToString())+"Logic.get"+GetNombreClase(tablaRelacionada.ToString())+"();\r\n\r\n\t\t\t\tif(isChanged"+GetNombreClase(tablaRelacionada.ToString())+") {";
					strLastCode+=GetSetVariablesToObjetoLogicActualizar(tablaRelacionada); 
					strLastCode+="\r\n\t\t\t\t} else {\r\n\t\t\t\t\t"+GetNombreClaseObjeto(tablaRelacionada.ToString())+".setIsDeleted(true);\r\n\t\t\t\t}\r\n\t\t\t}";
					strLastCode+="\r\n\r\n\t\t\t"+GetNombreClaseObjetoC(tablaRelacionada.ToString())+"s.add("+GetNombreClaseObjetoC(tablaRelacionada.ToString())+");";
						
					
					if(collectionInfo.CollectionRelationshipType==RelationshipType.OneToOne)
					{
						strLastCode+="\r\n\r\n\t\t\t"+GetNombreClaseObjeto(tablaRelacionada.ToString())+"="+GetNombreClaseObjeto(tablaRelacionada.ToString())+"Logic.get"+GetNombreClase(tablaRelacionada.ToString())+"();";
					}
					else if(collectionInfo.CollectionRelationshipType==RelationshipType.ManyToMany)
					{
						strLastCode+="\r\n\r\n\t\t\t"+GetNombreClaseObjeto(tablaRelacionada.ToString())+"s.add("+GetNombreClaseObjeto(tablaRelacionada.ToString())+"Logic.get"+GetNombreClase(tablaRelacionada.ToString())+"());";
					}	
					
						
					strTablaClaseRelacionada+=strFuncionInit+strFuncionBody+strVariables+strFuncionBody2+strVariablesDocumento+strLastCode+strFuncionEnd+"\r\n\r\n\treturn "+GetNombreClaseObjetoC(tablaRelacionada.ToString())+"s;\r\n}";								
				}
				
												
					

			}
			
			
			return strTablaClaseRelacionada; 
		}

public string GetNombreIdVariable(TableSchema table)
{
	String strNombreIdVariable="NONE";	
	String strPrefijo="";	
	String strColumna="";
	
	foreach(ColumnSchema column in table.Columns)
	{
		if(column.IsPrimaryKeyMember)
		{
			strPrefijo=" "+GetPrefijoTipoC(column);	
			strColumna=GetNombreColumnaClaseC(column);
			strNombreIdVariable=strPrefijo+strColumna+GetNombreClaseC(table.ToString());
		}
	}
			
	return strNombreIdVariable;
}

public string GetNombreIdVariable()
{
	String strNombreIdVariable="NONE";	
	String strPrefijo="";	
	String strColumna="";
	
	foreach(ColumnSchema column in TablaBase.Columns)
	{
		if(column.IsPrimaryKeyMember)
		{
			strPrefijo=" "+GetPrefijoTipoC(column);	
			strColumna=GetNombreColumnaClaseC(column);
			strNombreIdVariable=strPrefijo+strColumna+GetNombreClaseC(TablaBase.ToString());
		}
	}
			
	return strNombreIdVariable;
}

public string GetSetVariablesToObjetoLogicActualizar(TableSchema tableSchema)
{
	String strVariablesActualizar="\r\n";
	String strTipo="";	
	String strPrefijo="";	
	String strColumna="";		
	String strIfElse="";	
	
	
	foreach(ColumnSchema column in tableSchema.Columns)
	{
		if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired))
		{
				continue;
		}
		
		strTipo=GetTipoColumnaClaseC(column);	
		strPrefijo=GetPrefijoTipoC(column);	
		strColumna=GetNombreColumnaClaseC(column);	
		strIfElse="\r\nif(httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\"+i.tToString())== null||httpServletRequest.getParameter(\""+GetNameControlHtml(column) + "\"+i.toString())==\"\")\r\n{\r\n";
		strIfElse+=strPrefijo+strColumna+"=null;\r\n}\r\nelse\r\n{\r\n";	
		
		if(column.Name.Equals(strId))
		{
			//strVariablesActualizar+="\r\n\t\t\t\t\t"+GetNombreClaseObjeto(tableSchema.ToString())+"Logic.get"+GetNombreClase(tableSchema.ToString())+"().set"+strIdGetSet+"("+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+");";
			strVariablesActualizar+="\r\n\t\t\t\t\t"+GetNombreClaseObjeto(tableSchema.ToString())+".set"+strIdGetSet+"("+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+");";
			continue;
		}
		if(column.Name.Equals(strVersionRow))
		{
			//strVariablesActualizar+="\r\n\t\t\t\t\t"+GetNombreClaseObjeto(tableSchema.ToString())+"Logic.get"+GetNombreClase(tableSchema.ToString())+"().set"+strVersionRowGetSet+"("+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+");";
			strVariablesActualizar+="\r\n\t\t\t\t\t"+GetNombreClaseObjeto(tableSchema.ToString())+".set"+strVersionRowGetSet+"("+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+");";
			continue;
		}
		
		//strVariablesActualizar+="\r\n\t\t\t\t\t"+GetNombreClaseObjeto(tableSchema.ToString())+"Logic.get"+GetNombreClase(tableSchema.ToString())+"().setField_"+strPrefijo+ strColumna +"("+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+");";
		strVariablesActualizar+="\r\n\t\t\t\t\t"+GetNombreClaseObjeto(tableSchema.ToString())+".setField_"+strPrefijo+ strColumna +"("+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+");";
	}
	
	return  strVariablesActualizar;
}

public string GetSetVariablesToObjetoLogicNuevo(TableSchema tableSchema)
{
	String strVariablesNuevo="\r\n";
	String strTipo="";	
	String strPrefijo="";	
	String strColumna="";		
	String strIfElse="";	
	
	
	foreach(ColumnSchema column in tableSchema.Columns)
	{
		if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired)|| column.Name.Equals(strId)|| column.Name.Equals(strVersionRow))
		{
			continue;
		}
		
		strTipo=GetTipoColumnaClaseC(column);	
		strPrefijo=GetPrefijoTipoC(column);	
		strColumna=GetNombreColumnaClaseC(column);	
		strIfElse="\r\nif(httpServletRequest.getParameter(\""+GetNameControlHtml(column) +"\"+i.tToString())== null||httpServletRequest.getParameter(\""+GetNameControlHtml(column) + "\"+i.toString())==\"\")\r\n{\r\n";
		strIfElse+=strPrefijo+strColumna+"=null;\r\n}\r\nelse\r\n{\r\n";	

		//strVariablesNuevo+="\r\n\t\t\t\t"+GetNombreClaseObjeto(tableSchema.ToString())+"Logic.get"+GetNombreClase(tableSchema.ToString())+"().setField_"+strPrefijo+ strColumna +"("+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+");";
		strVariablesNuevo+="\r\n\t\t\t\t"+GetNombreClaseObjeto(tableSchema.ToString())+".setField_"+strPrefijo+ strColumna +"("+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+");";
	}
	
		
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	return  strVariablesNuevo;
}

public String GetNombreVariables(TableSchema table)
{
	
	String strVariables="\r\n";
	String strTipo="";
	String strPrefijo="";
	String strColumna="";
	
	foreach(ColumnSchema column in table.Columns)
	{
		strTipo=GetTipoColumnaClaseC(column);	
		strPrefijo=" "+GetPrefijoTipoC(column);	
		strColumna=GetNombreColumnaClaseC(column);	
		
		if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired))
		{
				continue;
		}
		strVariables+="\r\n\t\t"+strTipo+strPrefijo+strColumna+GetNombreClaseC(table.ToString())+";";
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	}
	
	return strVariables;
}

public string GetSetVariablesFormularioContador(TableSchema tableSchema,String table)
{
	String strVariables="";
	
	String strTipo="";	
	String strPrefijo="";	
	String strColumna="";
	String strIfElse="";
	strIfElse="";
	

	foreach(ColumnSchema column in tableSchema.Columns)
	{
		if(column.Name.Equals(strIsActive)|| column.Name.Equals(strIsExpired))
		{
				continue;
		}
		
		strTipo=GetTipoColumnaClaseC(column);	
		strPrefijo=" "+GetPrefijoTipoC(column);	
		strColumna=GetNombreColumnaClaseC(column);	
		strIfElse="\r\n\r\n\t\t\tif(httpServletRequest.getParameter(\""+column.Name +GetNombreClaseC(tableSchema.ToString())+"\"+i)== null||httpServletRequest.getParameter(\""+column.Name+GetNombreClaseC(tableSchema.ToString()) + "\"+i)==\"\"){";
		strIfElse+=strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+"=null;}\r\n\t\t\telse{";	
		
		strVariables+=strIfElse+strPrefijo+strColumna+GetNombreClaseC(tableSchema.ToString())+"="+GetTipoColumnaParse(column,"httpServletRequest.getParameter(\""+column.Name+GetNombreClaseC(tableSchema.ToString()) +"\"+i)")+";}";
	}	
	/*if(column.Name.Equals(strId))
	{
		strPrefijo=" ";
		strColumna=strId;
	}*/
	
	return strVariables;
}
</script>
<%=GetByDanLicence()%>

/*Empresa: <%=Empresa%>
 *Programador: <%=NombreProgramador%>
 *Descripcion: Clase que contiene todos los Accesos a BDD de tabla <%=TablaBase.ToString().Split('.')[1]%>
 * Fecha Creacion: <%= DateTime.Now.ToLongDateString() %>
 **CAMBIOS***** 
 * Motivo Cambio:
 * Nombre Programador:
 * Fecha Cambio:
 **************
 */

package <%=Empresa%>.<%= Package%>.<%=strPackagePresentation%>.<%=strPackageWeb%>.<%=strPackageServlet%>;

import javax.servlet.ServletConfig;
import javax.servlet.RequestDispatcher;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.*;
import javax.servlet.ServletContext;
import java.sql.SQLException;
import java.util.Date;
import java.util.ArrayList;
import java.util.Set;
import java.util.HashSet;
import java.util.HashMap;
import java.util.Map;
import java.io.File;
import java.io.PrintWriter;
//import javax.servlet.ServletOutputStream;

import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JRRuntimeException;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;
import net.sf.jasperreports.engine.util.JRLoader;
import net.sf.jasperreports.engine.export.JRHtmlExporter;
import net.sf.jasperreports.j2ee.servlets.BaseHttpServlet;
import net.sf.jasperreports.engine.JRExporterParameter;
import net.sf.jasperreports.engine.data.JRBeanArrayDataSource;

import <%=Empresa%>.<%=strPackageFramework%>.<%= Package%>.<%=strPackageBusiness%>.<%=strPackageEntities%>.Classe;
import <%=Empresa%>.<%=strPackageFramework%>.<%= Package%>.<%=strPackageUtils%>.*;
import <%=Empresa%>.<%= Package%>.<%= strPackageUtils%>.<%=GetNombreClase(TablaBase.ToString())%>ConstantesFunciones;
import <%=Empresa%>.<%= Package%>.<%=strPackageBusiness%>.<%=strPackageEntities%>.*;
import <%=Empresa%>.<%= Package%>.<%=strPackageBusiness%>.<%=strPackageLogic%>.*;
//import <%=Empresa%>.<%= Package%>.<%=strPackagePresentation%>.<%=strPackageReporte%>.<%=strPackageSource%>.<%=GetNombreClase(TablaBase.ToString())%>SourceReporte;
import <%=Empresa%>.<%= Package%>.<%=strPackagePresentation%>.<%=strPackageReporte%>.<%=strPackageSource%>.<%=GetNombreClase(TablaBase.ToString())%><%=strClaseBean%>;

<%=strGlobalSeguridadComment%>import Tame.Seguridad.Business.Logic.SistemaLogic;
<%=strGlobalSeguridadComment%>import Tame.Seguridad.Business.Logic.SistemaLogicAdditional;
<%=strGlobalSeguridadComment%>import Tame.Seguridad.Business.Logic.UsuarioLogic;
<%=strGlobalSeguridadComment%>import Tame.Seguridad.Business.Logic.UsuarioLogicAdditional;
import Tame.Seguridad.Business.Entities.Usuario;

<%if(ContieneImagenesC(TablaBase)){%>
	<%=GetFuncionesImagenesC(TablaBase)%>
	<%}%>


public class <%=GetNombreClase(TablaBase.ToString())%>Servlet extends javax.servlet.http.HttpServlet {
	private static final long serialVersionUID = 1L;
	
	protected void doGet(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse) throws ServletException, IOException {
		requestProcess(httpServletRequest,httpServletResponse);
	}  		
	
	protected void doPost(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse) throws ServletException, IOException {
		requestProcess(httpServletRequest,httpServletResponse);
	}
	
	protected void requestProcess(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse) throws ServletException, IOException {
		httpServletResponse.setHeader("Cache-Control","no-store"); //HTTP 1.1
		httpServletResponse.setHeader("Pragma","no-cache"); //HTTP 1.0
		httpServletResponse.setDateHeader("Expires", -1); 
		
		String sgenerarReporte="";
		Boolean isMostrarTodosResultadosReporte=false;
		String sDetalleReporte="";
		Boolean isReporteRelaciones=false;
		<%=GetNombreClase(TablaBase.ToString())%>Logic <%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic=null;
		<%=GetNombreClaseC(TablaBase.ToString())%> <%=GetNombreClaseObjetoC(TablaBase.ToString())%>=null;			
		<%=strTypeCollection%><<%=GetNombreClase(TablaBase.ToString())%>> <%=GetNombreClaseObjetoC(TablaBase.ToString())%>s=new <%=strTypeNewCollection%><<%=GetNombreClase(TablaBase.ToString())%>><%=strTypeNewCollectionEnd%>;
		<%=GetVariablesTablasClasesRelacionadas()%> 
		
		JasperPrint jasperPrint = null;
		RequestDispatcher requestDispatcher;

		Mensaje mensaje;
		String sXml =Mensaje.getMensajeGeneraldefault();
		HttpSession httpSession = httpServletRequest.getSession();
		Long iIdUsuarioSesion=0L;	
		Usuario usuarioActual=null;	
		Integer iNumeroDe<%=GetNombreClaseC(TablaBase.ToString())%>=0;
		sDetalleReporte="";
		isMostrarTodosResultadosReporte=false;
		ServletContext servletContext = this.getServletConfig().getServletContext();
		
		try {
				
			if(httpSession.getAttribute("usuarioActual")!=null) {
				usuarioActual=(Usuario)httpSession.getAttribute("usuarioActual");
				iIdUsuarioSesion=usuarioActual.getOid();
			} else {	
				<%=strGlobalSeguridadComment%>if(httpSession.getAttribute("AlumnoActual")==null)
				<%=strGlobalSeguridadComment%>{
				<%=strGlobalSeguridadComment%>mensaje=new Mensaje("verificarpermisosmantenimiento","Verificar permisos de usuario","Su sesion ha caducado, reinicie su sesion en la pagina inicial","false",MensajeGrupo.APLICACION);
				<%=strGlobalSeguridadComment%>httpServletResponse.setContentType("text/xml");
				<%=strGlobalSeguridadComment%>httpServletResponse.getWriter().write(sXml);
					
				<%=strGlobalSeguridadComment%>return;
				<%=strGlobalSeguridadComment%>}
			}
			
			<%=GetExtra1Servlet(TablaBase)%>
															
			String sAccionMantenimiento="";
			String sAccionBusqueda="";
			String sAccionAdicional="";
			String sUltimaBusqueda="";
			
			Boolean isNew<%=GetNombreClaseC(TablaBase.ToString())%>=false;
			Boolean isChanged<%=GetNombreClaseC(TablaBase.ToString())%>=false;
			Boolean isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>=false;
			<% for (int i = 0; i < TablaBase.Columns.Count; i++){ %>			
			<%if(TablaBase.Columns[i].Name==strIsActive||TablaBase.Columns[i].Name==strIsExpired){continue; } %>
			<%=  GetNombreVariables(TablaBase.Columns[i]) %>	
			<% } %>
			
			if(httpServletRequest.getParameter("accionMantenimiento")!=null) {
				sAccionMantenimiento=httpServletRequest.getParameter("accionMantenimiento");
			} else {
				if(httpSession.getAttribute("accionMantenimiento")!=null) {
					sAccionMantenimiento=(String)httpSession.getAttribute("accionMantenimiento");
					httpSession.removeAttribute("accionMantenimiento");
				}
			}
			
			if(httpServletRequest.getParameter("accionBusqueda")!=null) {
				sAccionBusqueda=httpServletRequest.getParameter("accionBusqueda");
			}
						
			if(httpServletRequest.getParameter("accionAdicional")!=null||httpServletRequest.getAttribute("accionAdicional")!=null) {
				if(httpServletRequest.getParameter("accionAdicional")!=null) {
					sAccionAdicional=httpServletRequest.getParameter("accionAdicional");
				} else {
					sAccionAdicional=httpServletRequest.getAttribute("accionAdicional").toString();
					httpServletRequest.removeAttribute("accionAdicional");
				}
				
				<%=GetNombreClase(TablaBase.ToString())%>ServletAdditional <%=GetNombreClaseObjeto(TablaBase.ToString())%>ServletAdditional=new <%=GetNombreClase(TablaBase.ToString())%>ServletAdditional(httpServletRequest,httpServletResponse,sAccionAdicional,servletContext);
				<%=GetNombreClaseObjeto(TablaBase.ToString())%>ServletAdditional.procesar();
				
				return;
			}
			
			if(httpSession.getAttribute("BusquedaDesdeForeignKeySesionForeignKey<%=GetNombreClaseC(TablaBase.ToString())%>")!=null) {
				if(httpSession.getAttribute("<%=strId%><%=GetNombreClase(TablaBase.ToString())%>ActualForeignKey")!=null) {
					sAccionBusqueda="Por<%=strIdGetSet%>";
					httpSession.setAttribute("<%=strId%><%=GetNombreClase(TablaBase.ToString())%>ActualForeignKeyParaPosibleAtras",(Long)httpSession.getAttribute("<%=strId%><%=GetNombreClase(TablaBase.ToString())%>ActualForeignKey"));
				}
				
				httpSession.setAttribute("BusquedaDesdeForeignKeySesionForeignKey<%=GetNombreClaseC(TablaBase.ToString())%>ParaPosibleAtras",true);				
				httpSession.removeAttribute("BusquedaDesdeForeignKeySesionForeignKey<%=GetNombreClaseC(TablaBase.ToString())%>");
			
			} else if(httpServletRequest.getParameter("esCargarPagina")==null&&httpSession.getAttribute("BusquedaDesdeForeignKeySesionForeignKey<%=GetNombreClaseC(TablaBase.ToString())%>ParaPosibleAtras")!=null) {
				if(httpSession.getAttribute("<%=strId%><%=GetNombreClase(TablaBase.ToString())%>ActualForeignKeyParaPosibleAtras")!=null) {
					sAccionBusqueda="Por<%=strIdGetSet%>";					
				}				
				
				httpSession.removeAttribute("BusquedaDesdeForeignKeySesionForeignKey<%=GetNombreClaseC(TablaBase.ToString())%>ParaPosibleAtras");
			}
			
			<%=GetBusquedaFromForeigKeysSession()%>
						
			else {
				if(httpServletRequest.getParameter("esCargarPagina")!=null&&httpSession.getAttribute("ultimaBusqueda<%=GetNombreClaseC(TablaBase.ToString())%>")!=null) {
					sUltimaBusqueda=(String)httpSession.getAttribute("ultimaBusqueda<%=GetNombreClaseC(TablaBase.ToString())%>");
					sUltimaBusqueda=sUltimaBusqueda.replace("&", "()");
					
					if(!sUltimaBusqueda.contains("esCargarPagina")) {
						sUltimaBusqueda+="()esCargarPagina=true";	
					}
					
					httpSession.removeAttribute("ultimaBusqueda<%=GetNombreClaseC(TablaBase.ToString())%>");
					
					mensaje=new Mensaje("Auxiliar","Ultima Busqueda",sUltimaBusqueda,MensajeGrupo.NONE);
					sXml = mensaje.toNewXmlMensaje();
	
					httpServletResponse.setContentType("text/xml");
					httpServletResponse.getWriter().write(sXml);
					
					return;
				}			
			}
			
			if(httpServletRequest.getParameter("ultimaBusqueda")!=null) {
				sUltimaBusqueda=httpServletRequest.getParameter("ultimaBusqueda");
				httpSession.setAttribute("ultimaBusqueda<%=GetNombreClaseC(TablaBase.ToString())%>", sUltimaBusqueda);
			}
						
			if(httpServletRequest.getParameter("generarReporte")!=null) {
				if(httpServletRequest.getParameter("esReporteRelaciones")!=null) {
					isReporteRelaciones=true;
				}
				
				if(httpServletRequest.getParameter("isMostrarTodosResultadosReporte")!=null) {
					isMostrarTodosResultadosReporte=Boolean.parseBoolean(httpServletRequest.getParameter("isMostrarTodosResultadosReporte"));					
				}
				
				sgenerarReporte=httpServletRequest.getParameter("generarReporte");
				
				if(sgenerarReporte.equals("HtmlGenerar")) {
					this.generarReporte<%=GetNombreClaseC(TablaBase.ToString())%>s(httpServletRequest, httpServletResponse, sAccionBusqueda,<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.get<%=GetNombreClaseC(TablaBase.ToString())%>s(),isReporteRelaciones,sDetalleReporte, <%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic,jasperPrint,sgenerarReporte);
				
				} else if(sgenerarReporte.equals("Html")) {
					httpSession.setAttribute("servletGenerarHtmlReporte", "<%=GetNombreClaseC(TablaBase.ToString())%>Servlet");
				}
			}
						
			if(sAccionMantenimiento.equals("guardar")) {
				
				<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic= new <%=GetNombreClase(TablaBase.ToString())%>Logic();
				
				if(httpServletRequest.getParameter("numeroDe<%=GetNombreClaseC(TablaBase.ToString())%>")!=null) {
					iNumeroDe<%=GetNombreClaseC(TablaBase.ToString())%>=Integer.parseInt(httpServletRequest.getParameter("numeroDe<%=GetNombreClaseC(TablaBase.ToString())%>"));
				}
				
				for (int i = 0; i < iNumeroDe<%=GetNombreClaseC(TablaBase.ToString())%>; i++) {
					isNew<%=GetNombreClaseC(TablaBase.ToString())%>=false;
					isChanged<%=GetNombreClaseC(TablaBase.ToString())%>=false;
					isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>=false;
					
					isNew<%=GetNombreClaseC(TablaBase.ToString())%>=Boolean.parseBoolean(httpServletRequest.getParameter("isNew<%=GetNombreClaseC(TablaBase.ToString())%>"+i));
					isChanged<%=GetNombreClaseC(TablaBase.ToString())%>=Boolean.parseBoolean(httpServletRequest.getParameter("isChanged<%=GetNombreClaseC(TablaBase.ToString())%>"+i));
					isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>=Boolean.parseBoolean(httpServletRequest.getParameter("isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>"+i));
					
					if(isNew<%=GetNombreClaseC(TablaBase.ToString())%>==false&&isChanged<%=GetNombreClaseC(TablaBase.ToString())%>==false&&isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>==false) {
						continue;
					}
					
					<% for (int i = 0; i < TablaBase.Columns.Count; i++){ %>					
					<%if(TablaBase.Columns[i].Name==strIsActive||TablaBase.Columns[i].Name==strIsExpired){continue; } %>
					<%=  GetSetVariablesFormularioContador(TablaBase.Columns[i],TablaBase.ToString()) %>	
					<% } %>
										
					if(isNew<%=GetNombreClaseC(TablaBase.ToString())%>) {
						<%=GetNombreClaseObjeto(TablaBase.ToString())%>=new <%=GetNombreClase(TablaBase.ToString())%>();						
						
						<% for (int i = 0; i < TablaBase.Columns.Count; i++){ %>
						<%if(TablaBase.Columns[i].Name==strIsActive||TablaBase.Columns[i].Name==strIsExpired||TablaBase.Columns[i].Name==strId||TablaBase.Columns[i].Name==strVersionRow){continue; } %>					
						<%= GetSetVariablesToObjetoLogicNuevo(TablaBase.Columns[i]) %>	
						<% } %>
												
					} else {
						
						<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.getEntity(<%=GetNombreIdVariable()%>);
						<%=GetNombreClaseObjeto(TablaBase.ToString())%>=<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.get<%=GetNombreClase(TablaBase.ToString())%>();
						
						if(isChanged<%=GetNombreClaseC(TablaBase.ToString())%>) {
							<% for (int i = 0; i < TablaBase.Columns.Count; i++){ %>
							<%if(TablaBase.Columns[i].Name==strIsActive||TablaBase.Columns[i].Name==strIsExpired){continue; } %>
							<%= GetSetVariablesToObjetoLogicActualizar(TablaBase.Columns[i]) %>	
							<% } %>
						} else {
							<%=GetNombreClaseObjeto(TablaBase.ToString())%>.setIsDeleted(true);
						}
					}
					
					<%=GetNombreClaseObjetoC(TablaBase.ToString())%>s.add(<%=GetNombreClaseObjeto(TablaBase.ToString())%>);					
				}
				
				<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.set<%=GetNombreClase(TablaBase.ToString())%>s(<%=GetNombreClaseObjetoC(TablaBase.ToString())%>s);	
				<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.save<%=GetNombreClase(TablaBase.ToString())%>sWithConnection(iIdUsuarioSesion,true,httpServletRequest.getRemoteHost(),httpServletRequest.getRemoteAddr());
								
				sXml = Mensaje.getMensajeGeneralActualizar("<%=GetNombreClaseC(TablaBase.ToString())%>");	
				
				httpServletResponse.setContentType("text/xml");
				httpServletResponse.getWriter().write(sXml);
				
			} <%if(GenerarTipoGeneracionC(strTipoGeneracionMantenimientoClasesRelacionadas,TiposGeneracion)) {%>
			else if(sAccionMantenimiento.equals("guardarrelaciones")) {
				<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic= new <%=GetNombreClase(TablaBase.ToString())%>Logic();
				
				if(httpServletRequest.getParameter("numeroDe<%=GetNombreClaseC(TablaBase.ToString())%>")!=null) {
					iNumeroDe<%=GetNombreClaseC(TablaBase.ToString())%>=Integer.parseInt(httpServletRequest.getParameter("numeroDe<%=GetNombreClaseC(TablaBase.ToString())%>"));
				}
				
				for (int i = 0; i < iNumeroDe<%=GetNombreClaseC(TablaBase.ToString())%>; i++) {
					isNew<%=GetNombreClaseC(TablaBase.ToString())%>=false;
					isChanged<%=GetNombreClaseC(TablaBase.ToString())%>=false;
					isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>=false;
					
					isNew<%=GetNombreClaseC(TablaBase.ToString())%>=Boolean.parseBoolean(httpServletRequest.getParameter("isNew<%=GetNombreClaseC(TablaBase.ToString())%>"+i));
					isChanged<%=GetNombreClaseC(TablaBase.ToString())%>=Boolean.parseBoolean(httpServletRequest.getParameter("isChanged<%=GetNombreClaseC(TablaBase.ToString())%>"+i));
					isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>=Boolean.parseBoolean(httpServletRequest.getParameter("isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>"+i));
					
					if(isNew<%=GetNombreClaseC(TablaBase.ToString())%>==false&&isChanged<%=GetNombreClaseC(TablaBase.ToString())%>==false&&isDeleted<%=GetNombreClaseC(TablaBase.ToString())%>==false) {
						continue;
					}
					
					<% for (int i = 0; i < TablaBase.Columns.Count; i++){ %>					
					<%if(TablaBase.Columns[i].Name==strIsActive||TablaBase.Columns[i].Name==strIsExpired){continue; } %>
					<%=  GetSetVariablesFormularioContador(TablaBase.Columns[i],TablaBase.ToString()) %>	
					<% } %>
										
					if(isNew<%=GetNombreClaseC(TablaBase.ToString())%>) {
						<%=GetNombreClaseObjeto(TablaBase.ToString())%>=new <%=GetNombreClase(TablaBase.ToString())%>();						
						
						<% for (int i = 0; i < TablaBase.Columns.Count; i++){ %>
						<%if(TablaBase.Columns[i].Name==strIsActive||TablaBase.Columns[i].Name==strIsExpired||TablaBase.Columns[i].Name==strId||TablaBase.Columns[i].Name==strVersionRow){continue; } %>					
						<%= GetSetVariablesToObjetoLogicNuevo(TablaBase.Columns[i]) %>	
						<% } %>												
						
					} else  {
						
						<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.getEntity(<%=GetNombreIdVariable()%>);
						<%=GetNombreClaseObjeto(TablaBase.ToString())%>=<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.get<%=GetNombreClase(TablaBase.ToString())%>();
						
						if(isChanged<%=GetNombreClaseC(TablaBase.ToString())%>) {
							<% for (int i = 0; i < TablaBase.Columns.Count; i++){ %>
							<%if(TablaBase.Columns[i].Name==strIsActive||TablaBase.Columns[i].Name==strIsExpired){continue; } %>
							<%= GetSetVariablesToObjetoLogicActualizar(TablaBase.Columns[i]) %>	
							<% } %>
						} else {
							<%=GetNombreClaseObjeto(TablaBase.ToString())%>.setIsDeleted(true);
						}
					}
					
					<%=GetNombreClaseObjeto(TablaBase.ToString())%>=<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.get<%=GetNombreClase(TablaBase.ToString())%>();					
				}
								
				<%=GetprocesarTablasClasesRelacionadas() %>
				
				<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.<%=GetMaintenanceTablasClasesRelacionadasRelaciones()%>	
																
				sXml = Mensaje.getMensajeGeneralActualizar("<%=GetNombreClaseC(TablaBase.ToString())%>");					
				
				httpServletResponse.setContentType("text/xml");
				httpServletResponse.getWriter().write(sXml);
			}
			<% } %>
			
			<%=GetFuncionesAccionesNavegacionTablasClasesRelacionadasC()%>
			
			<%=GenerarAccionesImagenServlet()%>
			
			else if(sAccionBusqueda!="") {
				procesarBusqueda(httpServletRequest,httpServletResponse,sAccionBusqueda,isReporteRelaciones,jasperPrint,<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic,sgenerarReporte,isMostrarTodosResultadosReporte,<%=GetNombreClaseObjetoC(TablaBase.ToString())%>s,sDetalleReporte);		
			}													
		} catch(SQLException e) {
			mensaje=new Mensaje("Excepcion de Base de Datos","Error en alguna operacion en la base de datos:"+e.getMessage(),e.getMessage(),MensajeGrupo.EXCEPTION);
			sXml = mensaje.toNewXmlMensaje();
			httpServletResponse.setContentType("text/xml");
			httpServletResponse.getWriter().write(sXml);
			
      	} catch(Exception e) {
			mensaje=new Mensaje("Excepcion de Aplicacion","Error de aplicacion",e.getMessage(),MensajeGrupo.EXCEPTION);
			sXml = mensaje.toNewXmlMensaje();
			httpServletResponse.setContentType("text/xml");
			httpServletResponse.getWriter().write(sXml);				
		}	    		
	}
	
	public void procesarBusqueda(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse,String sAccionBusqueda,Boolean isReporteRelaciones,JasperPrint jasperPrint,<%=GetNombreClaseC(TablaBase.ToString())%>Logic <%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic,String sgenerarReporte,Boolean isMostrarTodosResultadosReporte,<%=strTypeCollection%><<%=GetNombreClaseC(TablaBase.ToString())%>> <%=GetNombreClaseObjetoC(TablaBase.ToString())%>s,String sDetalleReporte) throws SQLException,Exception {		
		String sXml ="";
		String  sFinalQueryPaginacion="";
		Integer iInicioPaginacion;
		Integer iFinPaginacion;
		HttpSession httpSession = httpServletRequest.getSession();
		String strAccionPaginacion="";
				
		try {							
			if(httpServletRequest.getParameter("inicio")!=null&&httpServletRequest.getParameter("fin")!=null&&httpServletRequest.getParameter("tipo")!=null) {	
				strAccionPaginacion=httpServletRequest.getParameter("tipo");
				
				if(strAccionPaginacion.equals("ANTERIORES")) {
					iInicioPaginacion=Integer.parseInt(httpServletRequest.getParameter("inicio"));
					iFinPaginacion=Integer.parseInt(httpServletRequest.getParameter("fin"));
									
					sFinalQueryPaginacion=" <%=GetPrefijoSqlIdTableFromPropertiesC(TablaBase)%>OID<"+iInicioPaginacion.toString()+" <%=GetFinalQueryTableFromPropertiesC(TablaBase)%> ORDER BY <%=GetPrefijoSqlIdTableFromPropertiesC(TablaBase)%>OID DESC FETCH FIRST "+iFinPaginacion.toString()+" ROW ONLY";															
				} else {
					iInicioPaginacion=Integer.parseInt(httpServletRequest.getParameter("inicio"));
					iFinPaginacion=Integer.parseInt(httpServletRequest.getParameter("fin"));
					
					sFinalQueryPaginacion=" <%=GetPrefijoSqlIdTableFromPropertiesC(TablaBase)%>OID>"+iInicioPaginacion.toString()+" <%=GetFinalQueryTableFromPropertiesC(TablaBase)%> ORDER BY <%=GetPrefijoSqlIdTableFromPropertiesC(TablaBase)%>OID ASC FETCH FIRST "+iFinPaginacion.toString()+" ROW ONLY";			
				}				
			}
			
			if(sAccionBusqueda.equals("Todos")) {						
				<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.getTodos<%=GetNombreClase(TablaBase.ToString())%>s(<%=GetNombreOrderColumnFromPropertiesC(TablaBase)%>sFinalQueryPaginacion);
				sXml = <%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.getXml<%=GetNombreClaseC(TablaBase.ToString())%>s();				
				
				if(<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.get<%=GetNombreClaseC(TablaBase.ToString())%>s()==null|| <%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.get<%=GetNombreClaseC(TablaBase.ToString())%>s().size()==0) {
					sXml =Mensaje.getMensajeGeneralNoExisteBusqueda("<%=GetNombreClaseC(TablaBase.ToString())%>");
				}			
			
				if(sgenerarReporte!=""&&sgenerarReporte!=null) {
					if(isMostrarTodosResultadosReporte) {
						<%=GetNombreClaseObjetoC(TablaBase.ToString())%>s=<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.get<%=GetNombreClaseC(TablaBase.ToString())%>s();						
						<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.getTodos<%=GetNombreClase(TablaBase.ToString())%>s(<%=GetNombreOrderColumnFromPropertiesC(TablaBase)%>"");
						
					}
					
					generarReporte<%=GetNombreClase(TablaBase.ToString())%>s(httpServletRequest,httpServletResponse,"Todos",<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.get<%=GetNombreClaseC(TablaBase.ToString())%>s(),isReporteRelaciones,sDetalleReporte, <%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic,jasperPrint,sgenerarReporte);
					
					<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.set<%=GetNombreClaseC(TablaBase.ToString())%>s(<%=GetNombreClaseObjetoC(TablaBase.ToString())%>s);
				}
			
				httpServletResponse.setContentType("text/xml");
				httpServletResponse.getWriter().write(sXml);			
				
			} else if(sAccionBusqueda.equals("Por<%=strIdGetSet%>")) {
				Long <%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>=0L;
				
				if(httpServletRequest.getParameter("<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>")!=null) {
					<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>=Long.parseLong(httpServletRequest.getParameter("<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>"));	
				}
				
				if(httpSession.getAttribute("<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>ActualForeignKey")!=null) {
					<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>=(Long)httpSession.getAttribute("<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>ActualForeignKey");	
					
					httpSession.removeAttribute("<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>ActualForeignKey");
					
				} else if(httpSession.getAttribute("<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>ActualForeignKeyParaPosibleAtras")!=null) {
					<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>=(Long)httpSession.getAttribute("<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>ActualForeignKeyParaPosibleAtras");	
				
					httpSession.removeAttribute("<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>ActualForeignKeyParaPosibleAtras");
				}
				
				<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.getEntity(<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>);
				<%=GetNombreClaseC(TablaBase.ToString())%>ConstantesFunciones.getDetalleIndicePor<%=strIdGetSet%>(<%=strId%><%=GetNombreClaseC(TablaBase.ToString())%>);
					
				sXml = <%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.getXml<%=GetNombreClaseC(TablaBase.ToString())%>();
				
				if(<%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic.get<%=GetNombreClaseC(TablaBase.ToString())%>()==null) {
					sXml =Mensaje.getMensajeGeneralNoExisteBusqueda("<%=GetNombreClaseC(TablaBase.ToString())%>");
				}
			
				httpServletResponse.setContentType("text/xml");
				httpServletResponse.getWriter().write(sXml);			
			}
			
		<%=GetXmlBusquedasIndicesTablas()%> 
		
		<%if(GenerarTipoGeneracionC(strTipoGeneracionCompuestos,TiposGeneracion)) {%>
		<%if(!GetEsReporteFromPropertiesC(TablaBase)){%>
		<%=GetXmlBusquedasIndicesTablasCompuestos()%> 
		<%}%>
		<%}%>
		} catch(SQLException e) {
			throw e;
			
      	} catch (JRException e) {
			throw e;
		} catch(Exception e) {
			throw e;
      	}
	}	
	
	public void generarReporte<%=GetNombreClase(TablaBase.ToString())%>s(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse,String sAccionBusqueda,<%=strTypeCollection%><<%=GetNombreClase(TablaBase.ToString())%>> <%=GetNombreClaseObjetoC(TablaBase.ToString())%>sParaReportes,Boolean isReporteRelaciones,String sDetalleReporte, <%=GetNombreClaseC(TablaBase.ToString())%>Logic <%=GetNombreClaseObjetoC(TablaBase.ToString())%>Logic,JasperPrint jasperPrint,String sgenerarReporte) throws SQLException,Exception {
		ServletContext servletContext = this.getServletConfig().getServletContext();
		String sPathReportes="";
		
		File reportFile;
		File imageFile;
		
		imageFile= new File(servletContext.getRealPath("Imagenes/Logos/LogoReporte.jpg"));
		
		if(!isReporteRelaciones) {
			reportFile = new File(servletContext.getRealPath("Reportes/<%=GetRelativePathNavegacionFromTableFromPropertiesC(TablaBase)%><%=GetNombreClase(TablaBase.ToString())%>Design.jasper"));
		} else {
			reportFile = new File(servletContext.getRealPath("Reportes/<%=GetRelativePathNavegacionFromTableFromPropertiesC(TablaBase)%><%=GetNombreClase(TablaBase.ToString())%>MasterRelacionesDesign.jasper"));
			sPathReportes=reportFile.getPath().replace("<%=GetNombreClase(TablaBase.ToString())%>MasterRelacionesDesign.jasper", "");
		}
		
		if (!reportFile.exists()) {
			throw new JRRuntimeException("File WebappReport.jasper not found. The report design must be compiled first.");
		}
		
		Map<String, String> mapParameters = new HashMap<String, String>();
		
		mapParameters.put("titulo", Constantes.SAREADEPARTAMENTO);
		mapParameters.put("subtitulo", "<%=strReporteDe%> <%=GetTituloNombreTableFromPropertiesC(TablaBase)%><%=GetPluralTituloNombreTableFromPropertiesC(TablaBase)%>");
		mapParameters.put("busquedapor", <%=GetNombreClaseC(TablaBase.ToString())%>ConstantesFunciones.getNombreIndice(sAccionBusqueda)+sDetalleReporte);
		mapParameters.put("PATH_IMAGEN", imageFile.getPath());
		
		if(isReporteRelaciones) {
			mapParameters.put("SUBREPORT_DIR", sPathReportes);
		}
		
		JasperReport jasperReport = (JasperReport)JRLoader.loadObject(reportFile.getPath());
		
		ArrayList<Classe> classes=new ArrayList<Classe>();		
		
		if(isReporteRelaciones) {
	<%=GetClassClasesForeigKeysC(TablaBase)%>
	<%=GetClassClasesRelacionadasC(TablaBase)%>
			
		} else {
	<%=GetClassClasesForeigKeysC(TablaBase)%>
			
		}
		
		try {
			<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.getNewConnexionToDeep();
				
			for (<%=GetNombreClase(TablaBase.ToString())%> <%=GetNombreClaseObjeto(TablaBase.ToString())%>:<%=GetNombreClaseObjetoC(TablaBase.ToString())%>sParaReportes) {				
				<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.deepLoad(<%=GetNombreClaseObjeto(TablaBase.ToString())%>, false, DeepLoadType.INCLUDE, classes);					
			}
				
			<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.getConnexion().getConnection().commit();
				
		} catch(Exception e) {
			throw e;
			
		} finally {
			<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic.closeNewConnexionToDeep();
		}
				
		if(!sgenerarReporte.equals("HtmlGenerar")) {
			jasperPrint = JasperFillManager.fillReport(jasperReport,mapParameters, new JRBeanArrayDataSource(<%=GetNombreClase(TablaBase.ToString())%><%=strClaseBean%>.Traer<%=GetNombreClase(TablaBase.ToString())%><%=strClaseBean%>s(<%=GetNombreClaseObjetoC(TablaBase.ToString())%>sParaReportes).toArray()));
			httpServletRequest.getSession().setAttribute(BaseHttpServlet.DEFAULT_JASPER_PRINT_SESSION_ATTRIBUTE, jasperPrint);
		} else {
			PrintWriter printWriter = httpServletResponse.getWriter();
			JRHtmlExporter jrHtmlExporter = new JRHtmlExporter();
				
			jrHtmlExporter.setParameter(JRExporterParameter.JASPER_PRINT, httpServletRequest.getSession().getAttribute(BaseHttpServlet.DEFAULT_JASPER_PRINT_SESSION_ATTRIBUTE));
			jrHtmlExporter.setParameter(JRExporterParameter.OUTPUT_WRITER, printWriter);
			
			jrHtmlExporter.exportReport();
		}
	}
	
	<%=GetFuncionesMaintenanceTablasClasesRelacionadas()%>
	
	public void init() throws ServletException {		
		try {
			/*
			<%=GetNombreClaseObjeto(TablaBase.ToString())%>s= new <%=strTypeNewCollection%><<%=GetNombreClase(TablaBase.ToString())%>><%=strTypeNewCollectionEnd%>;
			<%=GetNombreClaseObjeto(TablaBase.ToString())%>Logic= new <%=GetNombreClase(TablaBase.ToString())%>Logic();		
			*/
			<%=GetVariablesNewTablasClasesRelacionadas()%>
		/*}catch(ServletException e) {
			throw e;
		*/	
		} catch(Exception e) {
			e.printStackTrace();
		}
	}
	
	public void init(ServletConfig config) throws ServletException {
		try {
			super.init(config);			
			
			if(<%=Empresa%>.framework.<%=Package%>.util.Constantes.SCONNEXION!=super.getServletContext().getInitParameter("Conexion<%=SoloSiEsParaSeguridadC(TablaBase.Database)%>")) {
				<%=Empresa%>.framework.<%=Package%>.util.Constantes.SCONNEXION=super.getServletContext().getInitParameter("Conexion<%=SoloSiEsParaSeguridadC(TablaBase.Database)%>");								
			}
			
			if(<%=Empresa%>.framework.<%=Package%>.util.Constantes.SCONNEXIONUSUARIO!=super.getServletContext().getInitParameter("ConexionUsuario")) {
				<%=Empresa%>.framework.<%=Package%>.util.Constantes.SCONNEXIONUSUARIO=super.getServletContext().getInitParameter("ConexionUsuario");
			}
			
			if(<%=Empresa%>.framework.<%=Package%>.util.Constantes.SCONNEXIONPASSWORD!=super.getServletContext().getInitParameter("ConexionPassword")) {
				<%=Empresa%>.framework.<%=Package%>.util.Constantes.SCONNEXIONPASSWORD=super.getServletContext().getInitParameter("ConexionPassword");
			}
						
			<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>if(bydan.framework.Auditoria.util.Constantes.getSConnexion()!=super.getServletContext().getInitParameter("ConexionAuditoria")) {
				<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>bydan.framework.Auditoria.util.Constantes.setSConnexion(super.getServletContext().getInitParameter("ConexionAuditoria"));
			<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>}
			
			<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>if(bydan.framework.Auditoria.util.Constantes.getSConnexionUsuario()!=super.getServletContext().getInitParameter("ConexionAuditoriaUsuario")) {
				<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>bydan.framework.Auditoria.util.Constantes.setSConnexionUsuario(super.getServletContext().getInitParameter("ConexionAuditoriaUsuario"));
			<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>}
			
			<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>if(bydan.framework.Auditoria.util.Constantes.getSConnexionPassword()!=super.getServletContext().getInitParameter("ConexionAuditoriaPassword")) {
				<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>bydan.framework.Auditoria.util.Constantes.setSConnexionPassword(super.getServletContext().getInitParameter("ConexionAuditoriaPassword"));
			<%=strGlobalAuditoriaInternaComment%><%=strGlobalAuditoriaComment%>}
			
						
			<%=strGlobalSeguridadComment%>if(ByDan.Framework.Seguridad.Utils.Constantes.getSConnexion()!=super.getServletContext().getInitParameter("ConexionSeguridad")) {
				<%=strGlobalSeguridadComment%>ByDan.Framework.Seguridad.Utils.Constantes.setSConnexion(super.getServletContext().getInitParameter("ConexionSeguridad"));
			<%=strGlobalSeguridadComment%>}
			
			<%=strGlobalSeguridadComment%>if(ByDan.Framework.Seguridad.Utils.Constantes.getSConnexionUsuario()!=super.getServletContext().getInitParameter("ConexionSeguridadUsuario")) {
				<%=strGlobalSeguridadComment%>ByDan.Framework.Seguridad.Utils.Constantes.setSConnexionUsuario(super.getServletContext().getInitParameter("ConexionSeguridadUsuario"));
			<%=strGlobalSeguridadComment%>}
			
			<%=strGlobalSeguridadComment%>if(ByDan.Framework.Seguridad.Utils.Constantes.getSConnexionPassword()!=super.getServletContext().getInitParameter("ConexionSeguridadPassword")) {
				<%=strGlobalSeguridadComment%>ByDan.Framework.Seguridad.Utils.Constantes.setSConnexionPassword(super.getServletContext().getInitParameter("ConexionSeguridadPassword"));
			<%=strGlobalSeguridadComment%>}
			
		} catch(ServletException e) {
			throw e;
		}
	}
}
